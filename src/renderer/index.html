<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AURA V3 - Hybrid AI DAW Mockup</title>
    <!-- IndexedDB Library -->
    <script src="https://cdn.jsdelivr.net/npm/idb@8/build/umd.js"></script>
    <style>
        /* Loading Spinner */
        #library-loader {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(26, 26, 32, 0.95);
            padding: 20px 40px;
            border-radius: 12px;
            border: 1px solid #4FD272;
            color: #4FD272;
            z-index: 9999;
            display: none;
            /* Hidden by default */
            flex-direction: column;
            align-items: center;
            gap: 15px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(79, 210, 114, 0.1);
            border-left-color: #4FD272;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            100% {
                transform: rotate(360deg);
            }
        }

        html {
            height: 100%;
            overflow: hidden;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Background Colors - BRIGHTER */
            --bg-main: #252530;
            --bg-gap: #020202;
            --bg-panel: #3A3D45;
            --bg-input: #32353D;
            --bg-transport: #2A2A35;

            /* Chat Colors */
            --chat-user: #2A3547;
            --chat-ai: #263D30;

            /* Track Colors - Dark backgrounds with neon borders */
            --chord-bg: #1E3A5F;
            --chord-border: #4A90D9;
            --drums-bg: #4A2020;
            --drums-border: #E85D4E;
            --bass-bg: #1E3D2F;
            --bass-border: #4FD272;
            --piano-bg: #1E3A4A;
            --piano-border: #5DADE2;
            --vocal-bg: #3D2050;
            --vocal-border: #9D65D8;

            /* Legacy - keep for compatibility */
            --chord-region: #314963;
            --track-chord: #314963;
            --track-drums: #E85D4E;
            --track-bass: #4FD272;
            --track-piano: #5DADE2;
            --track-vocal: #9D65D8;

            /* Button Colors */
            --rec-bg: #9B4342;
            --rec-circle: #F95F5B;
            --neon-cyan: #4DFFFF;
            --neon-purple: #D45FFF;

            /* Text Colors */
            --text-main: #C0C6C5;
            --text-muted: #808590;

            /* Layout */
            --corner-radius: 6px;
            --corner-radius-lg: 8px;
            --panel-gap: 6px;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background-color: var(--bg-gap);
            color: var(--text-main);
            height: 100%;
            overflow: hidden;
        }

        /* Main Layout */
        .app-container {
            display: grid;
            grid-template-rows: 180px 1fr;
            grid-template-columns: 280px 1fr 300px;
            height: 100vh;
            gap: var(--panel-gap);
            padding: var(--panel-gap);
        }

        /* Header - spans full width */
        .header {
            grid-column: 1 / -1;
            background-color: var(--bg-main);
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            align-items: center;
            padding: 0 20px;
            border-radius: var(--corner-radius-lg);
        }

        .header-left {
            justify-self: start;
        }

        .header-center {
            justify-self: center;
        }

        .header-right {
            justify-self: end;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .project-name {
            font-size: 16px;
            color: var(--text-main);
        }

        .undo-redo-group {
            display: flex;
            gap: 8px;
            margin-left: 12px;
        }

        .undo-redo-btn {
            background: transparent;
            border: none;
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
        }

        .undo-redo-btn svg {
            width: 20px;
            height: 20px;
            stroke: #888888;
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            transition: stroke 0.15s ease;
        }

        .undo-redo-btn:hover svg {
            stroke: #CCCCCC;
        }

        .header-btn {
            background: var(--bg-panel);
            border: none;
            color: var(--text-main);
            padding: 8px 16px;
            border-radius: var(--corner-radius);
            cursor: pointer;
            font-size: 12px;
        }

        .header-btn:hover {
            opacity: 0.8;
        }

        /* Transport Controls - Grouped in Box */
        .header-center {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .transport-group {
            display: flex;
            align-items: center;
            background: #0A0A0C;
            border-radius: 10px;
            padding: 6px;
            gap: 6px;
        }

        .transport-btn {
            width: 42px;
            height: 42px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s ease;
            outline: none;
        }

        .transport-btn:focus {
            outline: none;
        }

        .rec-btn:focus {
            outline: none;
        }

        /* Play Button - Green Neon (#4FD272) */
        .play-btn {
            background: rgba(79, 210, 114, 0.08);
            border: 1px solid rgba(79, 210, 114, 0.3);
            box-shadow: 0 0 6px rgba(79, 210, 114, 0.2),
                inset 0 0 8px rgba(79, 210, 114, 0.05);
        }

        .play-btn:hover {
            background: rgba(79, 210, 114, 0.15);
            border-color: rgba(79, 210, 114, 0.5);
            box-shadow: 0 0 12px rgba(79, 210, 114, 0.4),
                0 0 25px rgba(79, 210, 114, 0.2),
                inset 0 0 15px rgba(79, 210, 114, 0.1);
        }

        .play-btn:active {
            background: rgba(79, 210, 114, 0.25);
            border-color: rgba(79, 210, 114, 0.7);
            box-shadow: 0 0 20px rgba(79, 210, 114, 0.6),
                0 0 40px rgba(79, 210, 114, 0.3),
                0 0 60px rgba(79, 210, 114, 0.15),
                inset 0 0 20px rgba(79, 210, 114, 0.15);
            transform: scale(0.95);
        }

        .play-icon {
            width: 0;
            height: 0;
            border-left: 14px solid #4FD272;
            border-top: 9px solid transparent;
            border-bottom: 9px solid transparent;
            margin-left: 4px;
            filter: drop-shadow(0 0 4px rgba(79, 210, 114, 0.6));
            transition: all 0.15s ease;
        }

        .play-btn:hover .play-icon {
            filter: drop-shadow(0 0 8px rgba(79, 210, 114, 0.8));
        }

        .play-btn:active .play-icon {
            border-left-color: #80FF99;
            filter: drop-shadow(0 0 12px rgba(79, 210, 114, 1));
        }

        /* Play Button - Playing State (Neon Glow ON) */
        .play-btn.playing {
            background: rgba(79, 210, 114, 0.25);
            border-color: rgba(79, 210, 114, 0.8);
            box-shadow: 0 0 15px rgba(79, 210, 114, 0.6),
                0 0 30px rgba(79, 210, 114, 0.4),
                0 0 50px rgba(79, 210, 114, 0.2),
                inset 0 0 15px rgba(79, 210, 114, 0.15);
            animation: playGlow 1.5s ease-in-out infinite;
        }

        .play-btn.playing .play-icon {
            border-left-color: #80FF99;
            filter: drop-shadow(0 0 10px rgba(79, 210, 114, 1));
        }

        @keyframes playGlow {

            0%,
            100% {
                box-shadow: 0 0 15px rgba(79, 210, 114, 0.6),
                    0 0 30px rgba(79, 210, 114, 0.4),
                    0 0 50px rgba(79, 210, 114, 0.2),
                    inset 0 0 15px rgba(79, 210, 114, 0.15);
            }

            50% {
                box-shadow: 0 0 20px rgba(79, 210, 114, 0.8),
                    0 0 40px rgba(79, 210, 114, 0.5),
                    0 0 60px rgba(79, 210, 114, 0.3),
                    inset 0 0 20px rgba(79, 210, 114, 0.2);
            }
        }

        /* Stop Button - Yellow Neon (#FFD84D) */
        .stop-btn {
            background: rgba(255, 216, 77, 0.08);
            border: 1px solid rgba(255, 216, 77, 0.3);
            box-shadow: 0 0 6px rgba(255, 216, 77, 0.2),
                inset 0 0 8px rgba(255, 216, 77, 0.05);
        }

        .stop-btn:hover {
            background: rgba(255, 216, 77, 0.15);
            border-color: rgba(255, 216, 77, 0.5);
            box-shadow: 0 0 12px rgba(255, 216, 77, 0.4),
                0 0 25px rgba(255, 216, 77, 0.2),
                inset 0 0 15px rgba(255, 216, 77, 0.1);
        }

        .stop-btn:active,
        .stop-btn.pressed {
            background: rgba(255, 216, 77, 0.25);
            border-color: rgba(255, 216, 77, 0.7);
            box-shadow: 0 0 20px rgba(255, 216, 77, 0.6),
                0 0 40px rgba(255, 216, 77, 0.3),
                0 0 60px rgba(255, 216, 77, 0.15),
                inset 0 0 20px rgba(255, 216, 77, 0.15);
            transform: scale(0.95);
        }

        .stop-icon {
            width: 14px;
            height: 14px;
            background: #FFD84D;
            border-radius: 2px;
            box-shadow: 0 0 4px rgba(255, 216, 77, 0.6);
            transition: all 0.15s ease;
        }

        .stop-btn:hover .stop-icon {
            box-shadow: 0 0 8px rgba(255, 216, 77, 0.8);
        }

        .stop-btn:active .stop-icon {
            background: #FFEB80;
            box-shadow: 0 0 12px rgba(255, 216, 77, 1);
        }

        .rec-btn {
            background: rgba(249, 95, 91, 0.08);
            width: 42px;
            height: 42px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(249, 95, 91, 0.3);
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 0 8px rgba(249, 95, 91, 0.2),
                inset 0 0 10px rgba(249, 95, 91, 0.05);
            transition: all 0.15s ease;
        }

        .rec-btn:hover {
            background: rgba(249, 95, 91, 0.15);
            border-color: rgba(249, 95, 91, 0.5);
            box-shadow: 0 0 12px rgba(249, 95, 91, 0.4),
                0 0 25px rgba(249, 95, 91, 0.2),
                inset 0 0 15px rgba(249, 95, 91, 0.1);
        }

        .rec-btn:active {
            background: rgba(249, 95, 91, 0.25);
            border-color: rgba(249, 95, 91, 0.7);
            box-shadow: 0 0 20px rgba(249, 95, 91, 0.6),
                0 0 40px rgba(249, 95, 91, 0.3),
                0 0 60px rgba(249, 95, 91, 0.15),
                inset 0 0 20px rgba(249, 95, 91, 0.15);
            transform: scale(0.95);
        }

        .rec-btn .circle {
            width: 20px;
            height: 20px;
            background: var(--rec-circle);
            border-radius: 50%;
            box-shadow: 0 0 8px rgba(249, 95, 91, 0.6),
                0 0 15px rgba(249, 95, 91, 0.3);
            transition: box-shadow 0.15s ease;
        }

        .rec-btn:hover .circle {
            box-shadow: 0 0 12px rgba(249, 95, 91, 0.8),
                0 0 25px rgba(249, 95, 91, 0.5);
        }

        .rec-btn:active .circle {
            box-shadow: 0 0 18px rgba(249, 95, 91, 1),
                0 0 35px rgba(249, 95, 91, 0.7),
                0 0 50px rgba(249, 95, 91, 0.4);
        }

        /* Record Button - Recording State (ON) */
        .rec-btn.recording {
            background: rgba(249, 95, 91, 0.3);
            border-color: rgba(249, 95, 91, 0.9);
            box-shadow: 0 0 20px rgba(249, 95, 91, 0.7),
                0 0 40px rgba(249, 95, 91, 0.4),
                0 0 60px rgba(249, 95, 91, 0.2),
                inset 0 0 15px rgba(249, 95, 91, 0.2);
            animation: recPulse 1s ease-in-out infinite;
        }

        .rec-btn.recording .circle {
            background: #FF6B6B;
            box-shadow: 0 0 15px rgba(249, 95, 91, 1),
                0 0 30px rgba(249, 95, 91, 0.7),
                0 0 45px rgba(249, 95, 91, 0.4);
            animation: recCirclePulse 1s ease-in-out infinite;
        }

        @keyframes recPulse {

            0%,
            100% {
                box-shadow: 0 0 20px rgba(249, 95, 91, 0.7),
                    0 0 40px rgba(249, 95, 91, 0.4),
                    0 0 60px rgba(249, 95, 91, 0.2),
                    inset 0 0 15px rgba(249, 95, 91, 0.2);
            }

            50% {
                box-shadow: 0 0 25px rgba(249, 95, 91, 0.9),
                    0 0 50px rgba(249, 95, 91, 0.5),
                    0 0 70px rgba(249, 95, 91, 0.3),
                    inset 0 0 20px rgba(249, 95, 91, 0.25);
            }
        }

        @keyframes recCirclePulse {

            0%,
            100% {
                box-shadow: 0 0 15px rgba(249, 95, 91, 1),
                    0 0 30px rgba(249, 95, 91, 0.7),
                    0 0 45px rgba(249, 95, 91, 0.4);
                transform: scale(1);
            }

            50% {
                box-shadow: 0 0 20px rgba(249, 95, 91, 1),
                    0 0 40px rgba(249, 95, 91, 0.8),
                    0 0 55px rgba(249, 95, 91, 0.5);
                transform: scale(1.05);
            }
        }

        .transport-divider {
            width: 1px;
            height: 36px;
            background: #303035;
            margin: 0 8px;
        }

        .tempo-box {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            padding: 0 12px 0 6px;
        }

        .bpm-control {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .bpm-value {
            color: var(--text-main);
            font-size: 18px;
            font-weight: 500;
            line-height: 1.2;
            cursor: default;
            min-width: 75px;
        }

        .bpm-value:hover {
            color: #00FFFF;
        }

        .bpm-input {
            width: 80px;
            background: #1A1A20;
            border: 1px solid #00FFFF;
            border-radius: 3px;
            color: #00FFFF;
            font-size: 18px;
            font-weight: 500;
            padding: 4px 6px;
            text-align: left;
            outline: none;
            box-shadow: 0 0 6px rgba(0, 255, 255, 0.3);
            font-family: inherit;
        }

        .bpm-input:focus {
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        /* ?�자 input ?�피???�기�?*/
        .bpm-input::-webkit-outer-spin-button,
        .bpm-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .bpm-input[type=number] {
            -moz-appearance: textfield;
        }

        .bpm-arrows {
            display: flex;
            flex-direction: column;
            gap: 1px;
        }

        .bpm-arrow {
            width: 14px;
            height: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            border-radius: 2px;
            cursor: pointer;
            padding: 0;
            color: #606570;
            transition: all 0.1s ease;
            outline: none;
        }

        .bpm-arrow:hover {
            background: rgba(0, 255, 255, 0.15);
            color: #00FFFF;
        }

        .bpm-arrow:active {
            background: rgba(0, 255, 255, 0.3);
            color: #00FFFF;
        }

        .bpm-arrow svg {
            width: 8px;
            height: 5px;
        }

        .key-display {
            color: #606570;
            font-size: 12px;
            margin-top: 2px;
        }

        /* Metronome Button - 박스 ?�이 ?�이콘만 */
        .metronome-btn {
            width: 44px;
            height: 44px;
            background: transparent;
            border: none;
            outline: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s ease;
            position: relative;
        }

        .metronome-btn:hover {
            background: transparent;
            border: none;
            outline: none;
        }

        .metronome-btn:focus {
            outline: none;
            border: none;
        }

        .metronome-btn:focus-visible {
            outline: none;
        }

        .metronome-btn.active {
            background: transparent;
        }

        .metronome-icon {
            width: 26px;
            height: 26px;
            position: relative;
        }

        .metronome-icon svg {
            width: 100%;
            height: 100%;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .metronome-icon .metro-body {
            fill: rgba(80, 80, 100, 0.3);
            stroke: #606070;
            stroke-width: 1.2;
            transition: all 0.2s ease;
        }

        .metronome-icon .metro-pendulum {
            stroke: #808090;
            stroke-width: 1.5;
            stroke-linecap: round;
            transition: all 0.2s ease;
        }

        .metronome-icon .metro-weight {
            fill: #808090;
            transition: all 0.2s ease;
        }

        .metronome-icon .metro-tick {
            fill: #606070;
            transition: all 0.2s ease;
        }

        /* Hover State */
        .metronome-btn:hover .metro-body {
            fill: rgba(0, 255, 255, 0.08);
            stroke: rgba(0, 255, 255, 0.6);
        }

        .metronome-btn:hover .metro-pendulum {
            stroke: rgba(0, 255, 255, 0.8);
        }

        .metronome-btn:hover .metro-weight {
            fill: rgba(0, 255, 255, 0.9);
        }

        /* Active State - ?�온 글로우 */
        .metronome-btn.active .metro-body {
            fill: rgba(0, 255, 255, 0.12);
            stroke: var(--neon-cyan);
            filter: drop-shadow(0 0 3px rgba(0, 255, 255, 0.4));
        }

        .metronome-btn.active .metro-pendulum {
            stroke: var(--neon-cyan);
            filter: drop-shadow(0 0 4px rgba(0, 255, 255, 0.8));
        }

        .metronome-btn.active .metro-weight {
            fill: var(--neon-cyan);
            filter: drop-shadow(0 0 6px rgba(0, 255, 255, 1));
        }

        .metronome-btn.active .metro-tick {
            fill: rgba(0, 255, 255, 0.5);
        }

        /* Pendulum swing - JS�??�적 ?�어 */
        .metro-pendulum-group {
            transform-origin: 12px 18px;
            transition: transform 0.08s ease-out;
        }

        /* Header Right */
        .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .magic-mix-btn {
            background: rgba(77, 255, 255, 0.05);
            border: 2px solid var(--neon-cyan);
            color: var(--neon-cyan);
            padding: 10px 20px;
            border-radius: var(--corner-radius-lg);
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            text-shadow: 0 0 10px rgba(77, 255, 255, 0.8);
            box-shadow: 0 0 8px rgba(77, 255, 255, 0.4),
                0 0 20px rgba(77, 255, 255, 0.2),
                0 0 40px rgba(77, 255, 255, 0.1),
                inset 0 0 15px rgba(77, 255, 255, 0.05);
            transition: all 0.15s ease;
        }

        .magic-mix-btn:hover {
            background: rgba(77, 255, 255, 0.1);
            text-shadow: 0 0 15px rgba(77, 255, 255, 1);
            box-shadow: 0 0 12px rgba(77, 255, 255, 0.6),
                0 0 30px rgba(77, 255, 255, 0.4),
                0 0 60px rgba(77, 255, 255, 0.2),
                inset 0 0 20px rgba(77, 255, 255, 0.1);
        }

        .magic-mix-btn:active {
            background: rgba(77, 255, 255, 0.25);
            border-color: #80FFFF;
            color: #FFFFFF;
            text-shadow: 0 0 20px rgba(77, 255, 255, 1),
                0 0 40px rgba(77, 255, 255, 0.8);
            box-shadow: 0 0 20px rgba(77, 255, 255, 0.8),
                0 0 40px rgba(77, 255, 255, 0.5),
                0 0 80px rgba(77, 255, 255, 0.3),
                inset 0 0 30px rgba(77, 255, 255, 0.2);
            transform: scale(0.98);
        }

        .export-btn {
            background: rgba(212, 95, 255, 0.05);
            border: 2px solid var(--neon-purple);
            color: var(--neon-purple);
            padding: 10px 20px;
            border-radius: var(--corner-radius-lg);
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            text-shadow: 0 0 10px rgba(212, 95, 255, 0.8);
            box-shadow: 0 0 8px rgba(212, 95, 255, 0.4),
                0 0 20px rgba(212, 95, 255, 0.2),
                0 0 40px rgba(212, 95, 255, 0.1),
                inset 0 0 15px rgba(212, 95, 255, 0.05);
            transition: all 0.15s ease;
        }

        .export-btn:hover {
            background: rgba(212, 95, 255, 0.1);
            text-shadow: 0 0 15px rgba(212, 95, 255, 1);
            box-shadow: 0 0 12px rgba(212, 95, 255, 0.6),
                0 0 30px rgba(212, 95, 255, 0.4),
                0 0 60px rgba(212, 95, 255, 0.2),
                inset 0 0 20px rgba(212, 95, 255, 0.1);
        }

        .export-btn:active {
            background: rgba(212, 95, 255, 0.25);
            border-color: #E080FF;
            color: #FFFFFF;
            text-shadow: 0 0 20px rgba(212, 95, 255, 1),
                0 0 40px rgba(212, 95, 255, 0.8);
            box-shadow: 0 0 20px rgba(212, 95, 255, 0.8),
                0 0 40px rgba(212, 95, 255, 0.5),
                0 0 80px rgba(212, 95, 255, 0.3),
                inset 0 0 30px rgba(212, 95, 255, 0.2);
            transform: scale(0.98);
        }

        /* Icon Buttons */
        .icon-btn {
            background: var(--bg-panel);
            border: none;
            color: var(--text-main);
            width: 40px;
            height: 40px;
            border-radius: var(--corner-radius);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .icon-btn:hover {
            background: var(--bg-input);
        }

        /* Mixer Icon - 4 vertical bars */
        .mixer-icon {
            display: flex;
            gap: 3px;
            align-items: flex-end;
            height: 18px;
        }

        .mixer-bar {
            width: 3px;
            background: var(--text-main);
            border-radius: 1px;
        }

        .mixer-bar:nth-child(1) {
            height: 12px;
        }

        .mixer-bar:nth-child(2) {
            height: 18px;
        }

        .mixer-bar:nth-child(3) {
            height: 10px;
        }

        .mixer-bar:nth-child(4) {
            height: 15px;
        }

        /* Project Meta Icon - LP disc */
        .disc-icon {
            width: 20px;
            height: 20px;
            border: 2px solid var(--text-main);
            border-radius: 50%;
            position: relative;
        }

        .disc-icon::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 6px;
            height: 6px;
            background: var(--text-main);
            border-radius: 50%;
        }

        /* Resource Browser (Left Sidebar) */
        .resource-browser {
            background-color: var(--bg-main);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border-radius: var(--corner-radius-lg);
        }

        .sidebar-section {
            padding: 0 15px 15px 15px;
        }

        /* Status Bar */
        .status-bar {
            margin-top: auto;
            padding: 10px 15px;
            background: linear-gradient(180deg, rgba(20, 22, 28, 0.9) 0%, rgba(15, 17, 22, 0.95) 100%);
            border-top: 1px solid rgba(77, 255, 255, 0.15);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4FD272;
            box-shadow: 0 0 6px rgba(79, 210, 114, 0.6);
            animation: statusPulse 2s ease-in-out infinite;
        }

        .status-indicator.loading {
            background: #FFA500;
            box-shadow: 0 0 6px rgba(255, 165, 0, 0.6);
            animation: statusBlink 0.5s ease-in-out infinite;
        }

        .status-indicator.error {
            background: #FF6B6B;
            box-shadow: 0 0 6px rgba(255, 107, 107, 0.6);
            animation: none;
        }

        @keyframes statusPulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.6;
            }
        }

        @keyframes statusBlink {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.3;
            }
        }

        .status-text {
            font-size: 11px;
            color: #888;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
        }

        /* Engraved Panel Title Style - Clear & Readable */
        .section-title {
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2.5px;
            color: #5A5D65;
            text-shadow:
                0 1px 0 rgba(200, 205, 215, 0.5),
                0 -1px 0 rgba(0, 0, 0, 0.7);
            margin-bottom: 10px;
            text-align: center;
            padding: 6px 0;
            border-bottom: 1px solid #2A2D33;
        }

        .ai-generate-box {
            background: var(--bg-panel);
            border-radius: var(--corner-radius);
            padding: 15px;
            margin-bottom: 15px;
        }

        .ai-generate-box .desc {
            color: var(--text-muted);
            font-size: 12px;
            margin-bottom: 10px;
        }

        .prompt-input {
            background: var(--bg-input);
            border: 1px solid var(--bg-panel);
            border-radius: var(--corner-radius);
            color: var(--text-main);
            padding: 10px;
            width: 100%;
            height: 60px;
            resize: none;
            font-size: 12px;
            margin-bottom: 10px;
        }

        .generate-btn {
            background: rgba(77, 255, 255, 0.2);
            border: 1px solid var(--neon-cyan);
            color: var(--neon-cyan);
            padding: 8px 16px;
            border-radius: var(--corner-radius);
            cursor: pointer;
            font-size: 12px;
            float: right;
        }

        .menu-item {
            background: var(--bg-input);
            border-radius: var(--corner-radius);
            padding: 12px 15px;
            margin-bottom: 8px;
            cursor: pointer;
            font-size: 13px;
        }

        .menu-item:hover {
            background: var(--bg-panel);
        }

        /* Main Content Area */
        .main-content {
            display: grid;
            grid-template-rows: 1fr 40vh;
            gap: var(--panel-gap);
            height: 100%;
            overflow: hidden;
        }

        /* Timeline */
        .timeline {
            background-color: var(--bg-main);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            border-radius: var(--corner-radius-lg);
        }

        .timeline-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 15px;
            background: var(--bg-main);
            border-bottom: 1px solid #2A2D33;
            height: 36px;
        }

        .timeline-title {
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2.5px;
            color: #5A5D65;
            text-shadow:
                0 1px 0 rgba(200, 205, 215, 0.5),
                0 -1px 0 rgba(0, 0, 0, 0.7);
        }

        /* Timeline Toolbar */
        .timeline-toolbar {
            display: flex;
            align-items: center;
            gap: 4px;
            background: #1A1A20;
            border-radius: 6px;
            padding: 3px;
            border: 1px solid #303040;
        }

        .tool-btn {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            color: #606070;
            transition: all 0.12s ease;
        }

        .tool-btn:hover {
            background: rgba(255, 255, 255, 0.08);
            color: #909098;
        }

        .tool-btn.active {
            background: var(--neon-orange);
            color: #FFFFFF;
            box-shadow: 0 0 8px rgba(255, 140, 0, 0.5);
        }

        .tool-btn svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        .toolbar-divider {
            width: 1px;
            height: 20px;
            background: #303040;
            margin: 0 2px;
        }

        /* Timeline Body - Split Layout */
        .timeline-body {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        /* Track Headers Panel (Left) */
        .track-headers-panel {
            width: 150px;
            min-width: 100px;
            max-width: 300px;
            display: flex;
            flex-direction: column;
            background: var(--bg-main);
        }

        /* Resize Divider */
        .timeline-divider {
            width: 4px;
            background: #2A2D33;
            cursor: col-resize;
            flex-shrink: 0;
            transition: background 0.15s;
        }

        .timeline-divider:hover {
            background: #4A4D55;
        }

        .timeline-divider:active {
            background: var(--neon-cyan);
        }

        /* Track Content Panel (Right) */
        .track-content-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            /* Hide all scrollbars - use custom scrollbar instead */
            background: var(--bg-main);
        }

        /* Time Ruler */
        .time-ruler {
            display: flex;
            height: 30px;
            background: var(--bg-main);
            border-bottom: 1px solid #2A2D33;
            flex-shrink: 0;
        }

        .time-ruler-header {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
        }

        .expand-tracks-btn {
            width: 22px;
            height: 22px;
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2px;
            padding: 0;
            transition: all 0.3s ease;
        }

        .expand-tracks-btn:hover .expand-bar {
            background: #909090;
        }

        .expand-tracks-btn:hover .expand-arrow {
            border-left-color: #909090;
        }

        /* Three vertical bars */
        .expand-bar {
            width: 3px;
            height: 14px;
            background: #606570;
            border-radius: 1.5px;
        }

        .expand-bar:nth-child(1) {
            height: 10px;
        }

        .expand-bar:nth-child(2) {
            height: 14px;
        }

        .expand-bar:nth-child(3) {
            height: 10px;
        }

        /* Arrow pointing right */
        .expand-arrow {
            width: 0;
            height: 0;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-left: 8px solid #606570;
            margin-left: 2px;
            transition: all 0.3s ease;
        }

        .track-headers-panel.expanded .expand-tracks-btn {
            transform: rotate(180deg);
        }

        .track-headers-panel.expanded .expand-bar {
            background: var(--neon-cyan);
        }

        .track-headers-panel.expanded .expand-arrow {
            border-left-color: var(--neon-cyan);
        }

        .time-ruler-content {
            flex: 1;
            display: flex;
            position: relative;
            cursor: pointer;
            background:
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 24px,
                    #353540 24px,
                    #353540 25px),
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 99px,
                    #454550 99px,
                    #454550 100px);
        }

        .bar-marker {
            position: absolute;
            top: 4px;
            font-size: 11px;
            font-weight: 500;
            color: #909095;
        }

        .beat-tick {
            position: absolute;
            bottom: 0;
            width: 1px;
            background: #454550;
        }

        .beat-tick.bar {
            height: 12px;
            background: #606065;
        }

        .beat-tick.beat {
            height: 6px;
            background: #404045;
        }

        /* Chord Track - Same style as other tracks */
        .track-color-bar.chord {
            background: var(--track-chord);
        }

        /* Chord track content inherits from track-content-row */
        .chord-track-content {
            /* height inherited from .track-content-row */
        }

        .chord-block {
            position: absolute;
            top: 3px;
            bottom: 3px;
            background: var(--chord-border);
            border: 1px solid var(--chord-border);
            border-radius: 0px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 10px;
            font-size: 12px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .chord-divider {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            color: #505560;
            font-size: 16px;
        }

        /* Tracks Headers List (Left Panel) */
        .track-headers-list {
            flex: 1;
            overflow-y: auto;
            padding-top: 5px;
            /* Match spacing between tracks */
        }

        .track-header-row {
            height: 48px;
            display: flex;
            align-items: center;
            padding: 0 6px;
            background: var(--bg-main);
        }

        .track-header-box {
            flex: 1;
            height: 46px;
            background: #353840;
            display: flex;
            align-items: center;
            padding: 0;
            font-size: 13px;
            border-radius: 8px;
            overflow: hidden;
        }

        .track-header-box.selected {
            background: #556070;
        }

        .track-color-bar {
            width: 5px;
            height: 100%;
            flex-shrink: 0;
        }

        .track-color-bar.drums {
            background: var(--track-drums);
        }

        .track-color-bar.bass {
            background: var(--track-bass);
        }

        .track-color-bar.piano {
            background: var(--track-piano);
        }

        .track-color-bar.vocal {
            background: var(--track-vocal);
        }

        /* Tracks Content List (Right Panel) */
        .track-content-list {
            flex: 1;
            overflow: hidden;
            /* Hide all scrollbars - use custom scrollbar instead */
            position: relative;
            padding-top: 5px;
            /* Match spacing between tracks */
            cursor: pointer;
            /* Dark background with grid for entire track content area */
            background:
                /* Bar lines (100px) - brighter, more visible */
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 99px,
                    #3A3A45 99px,
                    #3A3A45 100px),
                /* Beat lines (25px) - subtle */
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 24px,
                    #1A1A22 24px,
                    #1A1A22 25px),
                #101015;
        }

        .track-content-row {
            height: 48px;
            position: relative;
            background:
                /* Bar lines (100px) - brighter, more visible */
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 99px,
                    #3A3A45 99px,
                    #3A3A45 100px),
                /* Beat lines (25px) - subtle */
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 24px,
                    #1A1A22 24px,
                    #1A1A22 25px),
                #101015;
            border-bottom: 1px solid #252530;
        }

        .track-name {
            flex: 1;
            color: var(--text-main);
            padding-left: 10px;
        }

        .track-menu {
            display: grid;
            grid-template-columns: repeat(2, 4px);
            grid-template-rows: repeat(3, 4px);
            gap: 3px;
            cursor: pointer;
            margin-right: 10px;
        }

        .track-menu-dot {
            width: 4px;
            height: 4px;
            background: #505560;
            border-radius: 50%;
        }

        /* Track Header Expandable Controls */
        .track-headers-panel {
            transition: width 0.3s ease;
        }

        .track-headers-panel.expanded {
            width: 280px !important;
        }

        .track-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
            margin-right: 8px;
            opacity: 0;
            max-width: 0;
            overflow: hidden;
            transition: opacity 0.3s ease, max-width 0.3s ease;
        }

        .track-headers-panel.expanded .track-controls {
            opacity: 1;
            max-width: 200px;
        }

        .track-headers-panel.expanded .track-name {
            flex: none;
            width: 50px;
        }

        /* Track Knob Controls */
        .track-knob-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .track-knob {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #3A3D45;
            border: 2px solid;
            position: relative;
            cursor: pointer;
        }

        .track-knob.volume {
            border-color: #4FD272;
        }

        .track-knob.pan {
            border-color: #5DADE2;
        }

        /* Knob indicator line */
        .track-knob::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 8px;
            background: #FFFFFF;
            top: 3px;
            left: 50%;
            transform: translateX(-50%) rotate(45deg);
            transform-origin: bottom center;
            border-radius: 1px;
        }

        .track-knob.pan::after {
            transform: translateX(-50%) rotate(0deg);
        }

        .track-knob-label {
            font-size: 8px;
            color: #707580;
            text-transform: uppercase;
        }

        /* Track Control Buttons */
        .track-btn {
            width: 20px;
            height: 20px;
            border: none;
            border-radius: 3px;
            font-size: 10px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #353840;
            color: #707580;
            transition: all 0.15s ease;
        }

        .track-btn:hover {
            background: #454A55;
        }

        .track-btn.mute {
            color: #707580;
        }

        .track-btn.mute.active {
            background: #FFB800;
            color: #1A1A20;
        }

        .track-btn.solo {
            color: #707580;
        }

        .track-btn.solo.active {
            background: #4FD272;
            color: #1A1A20;
        }

        .track-btn.rec {
            color: #707580;
        }

        .track-btn.rec.active {
            background: #FF4444;
            color: #FFFFFF;
        }

        /* Track Regions - Cubase style */
        .track-region {
            position: absolute;
            top: 3px;
            bottom: 3px;
            border-radius: 0px;
            border: 1px solid;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            padding: 2px 6px;
            font-size: 10px;
            font-weight: 700;
            overflow: hidden;
        }

        .track-region .region-label {
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
            z-index: 2;
        }

        /* Track-specific colors - Opaque (unselected) */
        .track-region.drums-region {
            background: var(--drums-border);
            border-color: var(--drums-border);
        }

        .track-region.bass-region {
            background: var(--bass-border);
            border-color: var(--bass-border);
        }

        .track-region.piano-region {
            background: var(--piano-border);
            border-color: var(--piano-border);
        }

        .track-region.vocal-region {
            background: var(--vocal-border);
            border-color: var(--vocal-border);
        }

        /* Selected clip style - Semi-transparent with brighter border */
        .track-region.drums-region.selected {
            background: rgba(232, 93, 78, 0.35);
            border-color: #FF8A7A;
        }

        .track-region.bass-region.selected {
            background: rgba(79, 210, 114, 0.35);
            border-color: #7FFF9A;
        }

        .track-region.piano-region.selected {
            background: rgba(93, 173, 226, 0.35);
            border-color: #8DDFFF;
        }

        .track-region.vocal-region.selected {
            background: rgba(157, 101, 216, 0.35);
            border-color: #C995FF;
        }

        .chord-block.selected {
            background: rgba(74, 144, 217, 0.35);
            border-color: #6AB0FF;
        }

        /* Drum patterns visualization */
        .drum-pattern {
            position: absolute;
            bottom: 4px;
            left: 6px;
            right: 6px;
            top: 18px;
            display: flex;
            align-items: flex-end;
            gap: 3px;
        }

        .drum-hit {
            width: 8px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 0px;
        }

        .drums-region.selected .drum-hit {
            background: var(--drums-border);
        }

        /* Bass/Piano waveform visualization */
        .waveform {
            position: absolute;
            bottom: 4px;
            left: 6px;
            right: 6px;
            top: 18px;
            display: flex;
            align-items: center;
            gap: 2px;
        }

        .wave-bar {
            width: 3px;
            border-radius: 0px;
            background: rgba(255, 255, 255, 0.5);
        }

        .bass-region.selected .wave-bar {
            background: var(--bass-border);
        }

        .piano-region.selected .wave-bar {
            background: var(--piano-border);
        }

        /* Auto-fill ghost region */
        .auto-fill-region {
            position: absolute;
            top: 3px;
            bottom: 3px;
            border: 1px dashed var(--piano-border);
            border-radius: 0px;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
        }

        .auto-fill-label {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 11px;
            color: var(--piano-border);
        }

        .auto-fill-arrow {
            font-size: 14px;
        }

        /* Vocal region with waveform */
        .vocal-waveform {
            position: absolute;
            top: 18px;
            bottom: 4px;
            left: 6px;
            right: 6px;
            display: flex;
            align-items: center;
            gap: 1px;
        }

        .vocal-wave {
            width: 2px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 0px;
        }

        .vocal-region.selected .vocal-wave {
            background: var(--vocal-border);
        }

        .vocal-circle {
            position: absolute;
            left: 6px;
            top: 18px;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .vocal-region.selected .vocal-circle {
            border-color: var(--vocal-border);
        }

        .vocal-circle::after {
            content: '';
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
        }

        .vocal-region.selected .vocal-circle::after {
            background: var(--vocal-border);
        }

        /* Playhead - Neon Cyan */
        .playhead {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 1px;
            background: #00FFFF;
            z-index: 100;
            pointer-events: none;
            box-shadow: 0 0 4px #00FFFF,
                0 0 8px rgba(0, 255, 255, 0.6),
                0 0 12px rgba(0, 255, 255, 0.3);
        }

        .playhead::before {
            content: '';
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 8px solid #00FFFF;
            filter: drop-shadow(0 0 4px #00FFFF);
        }

        /* Timeline scrollbar area - Cubase style */
        .timeline-scroll-area {
            height: 16px;
            background: #1A1A1E;
            display: flex;
            align-items: center;
            padding: 0;
            border-top: 1px solid #2A2A30;
        }

        .timeline-scroll {
            flex: 1;
            height: 100%;
            background: #1A1A1E;
            position: relative;
            display: flex;
            align-items: center;
        }

        .timeline-scroll-thumb {
            position: absolute;
            left: 50px;
            width: 120px;
            height: 10px;
            background: linear-gradient(180deg, #5A5A62 0%, #3A3A42 100%);
            border-radius: 2px;
            border: 1px solid #6A6A72;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
            cursor: grab;
        }

        .timeline-scroll-thumb:hover {
            background: linear-gradient(180deg, #6A6A72 0%, #4A4A52 100%);
            border-color: #7A7A82;
        }

        .timeline-scroll-thumb:active {
            cursor: grabbing;
            background: linear-gradient(180deg, #7A7A82 0%, #5A5A62 100%);
        }

        /* Vertical Scrollbar (Right side) - Cubase style */
        .timeline-vertical-scroll {
            width: 16px;
            background: #1A1A1E;
            display: flex;
            flex-direction: column;
            align-items: center;
            border-left: 1px solid #2A2A30;
        }

        .vertical-scroll-track {
            flex: 1;
            width: 100%;
            position: relative;
            display: flex;
            justify-content: center;
            padding: 4px 0;
        }

        .vertical-scroll-thumb {
            position: absolute;
            top: 30px;
            width: 10px;
            height: 100px;
            background: linear-gradient(90deg, #5A5A62 0%, #3A3A42 100%);
            border-radius: 2px;
            border: 1px solid #6A6A72;
            box-shadow: inset 1px 0 0 rgba(255, 255, 255, 0.1);
            cursor: grab;
        }

        .vertical-scroll-thumb:hover {
            background: linear-gradient(90deg, #6A6A72 0%, #4A4A52 100%);
            border-color: #7A7A82;
        }

        .vertical-scroll-thumb:active {
            cursor: grabbing;
            background: linear-gradient(90deg, #7A7A82 0%, #5A5A62 100%);
        }

        /* Scroll corner (intersection of H and V scrollbars) */
        .scroll-corner {
            width: 16px;
            height: 16px;
            background: #1A1A1E;
            flex-shrink: 0;
        }

        /* Detail Editor - Cubase Style */
        /* Grid에서 380px을 할당받음 - 명시적 height와 position: relative */
        .detail-editor {
            background-color: var(--bg-main);
            display: flex;
            flex-direction: column;
            height: 380px;
            /* Grid에서 받는 높이를 명시적으로 지정 */
            position: relative;
            border-radius: var(--corner-radius-lg);
            overflow: hidden;
        }

        .detail-editor-header {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 36px;
            flex-shrink: 0;
            /* 절대 줄어들지 않음 */
            background: var(--bg-main);
            border-bottom: 1px solid #2A2D33;
            padding: 0 12px;
            position: relative;
        }

        .detail-editor-title {
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2.5px;
            color: #5A5D65;
            text-shadow:
                0 1px 0 rgba(200, 205, 215, 0.5),
                0 -1px 0 rgba(0, 0, 0, 0.7);
        }

        /* Edit Dock Tabs */
        .edit-dock-tabs {
            display: flex;
            align-items: flex-end;
            gap: 4px;
            height: 100%;
            position: absolute;
            left: 12px;
        }

        .edit-dock-tab {
            background: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            color: #808590;
            padding: 8px 16px;
            border-radius: 4px 4px 0 0;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.15s;
        }

        .edit-dock-tab:hover {
            color: #C0C6C5;
            background: rgba(255, 255, 255, 0.03);
        }

        .edit-dock-tab.active {
            background: #3A3D45;
            color: #C0C6C5;
            border-bottom: 2px solid #4DFFFF;
        }

        .editor-tabs {
            display: none;
        }

        .editor-tab {
            background: transparent;
            border: none;
            color: var(--text-muted);
            padding: 6px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.15s;
        }

        .editor-tab:hover {
            color: var(--text-main);
            background: rgba(255, 255, 255, 0.05);
        }

        .editor-tab.active {
            background: #2A2D35;
            color: var(--text-main);
        }

        /* Edit Dock Panels Container - Flex로 나머지 공간 채움 */
        .edit-dock-panels-container {
            flex: 1;
            /* header(36px) 빼고 나머지 344px 채움 */
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-height: 0;
            /* flex overflow 방지 */
        }

        /* Edit Dock Panels - 컨테이너 내부를 꽉 채움 */
        .edit-dock-panel {
            display: none;
            flex-direction: column;
            flex: 1;
            width: 100%;
            overflow-y: auto;
            min-height: 0;
            background: #1A1A20;
        }

        .edit-dock-panel.active {
            display: flex !important;
        }

        .empty-panel-placeholder {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #555;
            font-size: 18px;
            font-weight: 500;
            background: #1A1A20;
        }

        /* ==================== Step Sequencer Styles ==================== */
        /* Wrapper - Always flex-start, centering via marginLeft in JS */
        .step-seq-wrapper {
            flex: 1;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #0D1117;
            padding: 15px;
            overflow-x: auto;
            overflow-y: hidden;
            position: relative;
            gap: 16px;
        }

        /* ============================================
           3-Column Layout: Left Panel - Center - Right Panel
           ============================================ */

        /* Glassmorphism Panel Base Style */
        .wing-panel {
            background: rgba(15, 20, 30, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(77, 255, 255, 0.25);
            border-radius: 12px;
            box-shadow:
                0 4px 20px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            padding: 12px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        /* Left Panel - Groove Extractor */
        .groove-panel {
            width: 220px;
            min-width: 220px;
            max-height: 360px;
        }

        .groove-panel .panel-title {
            font-size: 0.65rem;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: #4DFFFF;
            text-shadow: 0 0 8px rgba(77, 255, 255, 0.6);
            margin-bottom: 4px;
            text-align: center;
        }

        /* Drop Zone */
        .groove-drop-zone {
            border: 2px dashed rgba(77, 255, 255, 0.35);
            border-radius: 8px;
            padding: 16px 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background: rgba(77, 255, 255, 0.03);
        }

        .groove-drop-zone:hover {
            border-color: rgba(77, 255, 255, 0.6);
            background: rgba(77, 255, 255, 0.08);
        }

        .groove-drop-zone.dragover {
            border-color: #4DFFFF;
            background: rgba(77, 255, 255, 0.15);
            box-shadow: 0 0 15px rgba(77, 255, 255, 0.3);
        }

        .groove-drop-icon {
            width: 28px;
            height: 28px;
            margin: 0 auto 8px;
            color: rgba(77, 255, 255, 0.5);
        }

        .groove-drop-text {
            font-size: 0.7rem;
            color: #6B7280;
            line-height: 1.4;
        }

        .groove-drop-text strong {
            color: #9BA3B0;
            display: block;
            margin-bottom: 2px;
        }

        /* Waveform Canvas */
        .groove-waveform {
            height: 50px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            border: 1px solid rgba(77, 255, 255, 0.15);
            position: relative;
            overflow: hidden;
        }

        .groove-waveform canvas {
            width: 100%;
            height: 100%;
        }

        .groove-waveform-placeholder {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
            color: #4B5563;
            letter-spacing: 1px;
        }

        /* Analyze Button */
        .groove-analyze-btn {
            background: linear-gradient(135deg, rgba(77, 255, 255, 0.15), rgba(77, 255, 255, 0.05));
            border: 1px solid rgba(77, 255, 255, 0.4);
            border-radius: 6px;
            padding: 8px 12px;
            color: #4DFFFF;
            font-size: 0.7rem;
            font-weight: 600;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
        }

        .groove-analyze-btn:hover {
            background: linear-gradient(135deg, rgba(77, 255, 255, 0.25), rgba(77, 255, 255, 0.1));
            box-shadow: 0 0 12px rgba(77, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        .groove-analyze-btn:active {
            transform: translateY(0);
        }

        .groove-analyze-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        /* Groove Amount Slider */
        .groove-slider-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .groove-slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.65rem;
        }

        .groove-slider-label span:first-child {
            color: #9BA3B0;
        }

        .groove-slider-label span:last-child {
            color: #4DFFFF;
            font-weight: 600;
        }

        .groove-slider-input {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 4px;
            background: rgba(30, 35, 45, 0.9);
            border-radius: 2px;
            border: 1px solid rgba(77, 255, 255, 0.2);
            cursor: pointer;
            outline: none;
        }

        .groove-slider-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            background: linear-gradient(135deg, #4DFFFF, #3AC9C9);
            border-radius: 50%;
            border: 2px solid rgba(77, 255, 255, 0.8);
            cursor: pointer;
            box-shadow: 0 0 6px rgba(77, 255, 255, 0.5);
        }

        .groove-slider-input::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: linear-gradient(135deg, #4DFFFF, #3AC9C9);
            border-radius: 50%;
            border: 2px solid rgba(77, 255, 255, 0.8);
            cursor: pointer;
        }

        /* Right Panel - Global Controls */
        .global-panel {
            width: 110px;
            min-width: 110px;
            max-height: 360px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .global-panel .panel-title {
            font-size: 0.65rem;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: #D45FFF;
            text-shadow: 0 0 8px rgba(212, 95, 255, 0.6);
            margin-bottom: 4px;
            text-align: center;
        }

        /* Global Control Items */
        .global-control-item {
            display: flex;
            flex-direction: column;
            gap: 6px;
            padding: 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .global-control-item .control-label {
            font-size: 0.6rem;
            color: #9BA3B0;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-align: center;
        }

        /* Kit Morph Button in Global Panel */
        .global-kit-morph {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 10px 8px;
            background: rgba(212, 95, 255, 0.08);
            border: 1px solid rgba(212, 95, 255, 0.3);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .global-kit-morph:hover {
            background: rgba(212, 95, 255, 0.15);
            box-shadow: 0 0 10px rgba(212, 95, 255, 0.3);
        }

        .global-kit-morph .morph-icon {
            width: 20px;
            height: 20px;
            color: #D45FFF;
        }

        .global-kit-morph .morph-label {
            font-size: 0.55rem;
            color: #D45FFF;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Humanize in Global Panel */
        .global-humanize,
        .global-swing {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .global-humanize .humanize-header,
        .global-swing .humanize-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .global-humanize .humanize-label,
        .global-swing .humanize-label {
            font-size: 0.6rem;
            color: #9BA3B0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .global-humanize .humanize-value,
        .global-swing .humanize-value {
            font-size: 0.65rem;
            color: #4DFFFF;
            font-weight: 600;
        }

        .global-humanize .humanize-slider,
        .global-swing .humanize-slider {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 4px;
            background: rgba(30, 35, 45, 0.9);
            border-radius: 2px;
            border: 1px solid rgba(77, 255, 255, 0.2);
            cursor: pointer;
            outline: none;
        }

        .global-humanize .humanize-slider::-webkit-slider-thumb,
        .global-swing .humanize-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            background: linear-gradient(135deg, #4DFFFF, #3AC9C9);
            border-radius: 50%;
            border: 2px solid rgba(77, 255, 255, 0.8);
            cursor: pointer;
            box-shadow: 0 0 6px rgba(77, 255, 255, 0.5);
        }

        .global-humanize .humanize-slider::-moz-range-thumb,
        .global-swing .humanize-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: linear-gradient(135deg, #4DFFFF, #3AC9C9);
            border-radius: 50%;
            border: 2px solid rgba(77, 255, 255, 0.8);
            cursor: pointer;
        }


        /* Main Container - Outer Neon Border Box */
        .step-seq-container {
            display: flex;
            flex-direction: row;
            background: #1A1A20;
            border: 2px solid #4DFFFF;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(77, 255, 255, 0.4), inset 0 0 30px rgba(0, 0, 0, 0.5);
            padding: 15px;
            /* Symmetrical padding */
            gap: 0;
            width: fit-content;
            /* Keep fit-content for width so it wraps tracks */
            margin: 0;
            /* Align with flex layout of parent */
            flex: 0 0 auto;
            /* Allow growing to fill parent height/width if needed, but mostly height */
            gap: 0;
            /* Control spacing via margin instead */
            /* Right spacing increased for Vertical Control Stack */
            padding-right: 116px;
            position: relative;
            height: 100%;
            min-width: 0;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Left - Track Headers Area (wrapper like grid-area) */
        .step-seq-tracks-area {
            width: 150px;
            min-width: 150px;
            display: flex;
            flex-direction: column;
            height: 100%;
            /* Fill container height */
            /* max-height: 320px; REMOVED for vertical expansion */
        }

        /* Left - Track Headers (scroll container) */
        .step-seq-tracks {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 6px 0 6px 0;
            /* Match grid-scroll vertical padding */
            min-height: 0;
            /* Allow shrinking for overflow to work */
        }

        /* Track scrollbar - hidden by default, visible when tracks overflow */
        .step-seq-tracks::-webkit-scrollbar {
            width: 4px;
        }

        .step-seq-tracks::-webkit-scrollbar-track {
            background: transparent;
        }

        .step-seq-tracks::-webkit-scrollbar-thumb {
            background: rgba(77, 255, 255, 0.3);
            border-radius: 2px;
        }

        .step-seq-tracks::-webkit-scrollbar-thumb:hover {
            background: rgba(77, 255, 255, 0.5);
        }

        .step-seq-track-header {
            height: 56px;
            min-height: 56px;
            /* Prevent shrinking */
            flex-shrink: 0;
            /* Never shrink in flex container */
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 4px 8px;
            margin-bottom: 4px;
            border-radius: 6px;
        }

        .step-seq-track-header:last-child {
            margin-bottom: 0;
        }

        /* Track header backgrounds - darker version of track color */
        .step-seq-track-header[data-track="kick"] {
            background: rgba(255, 107, 107, 0.25);
            border-left: 3px solid #FF6B6B;
        }

        .step-seq-track-header[data-track="snare"] {
            background: rgba(77, 255, 255, 0.18);
            border-left: 3px solid #4DFFFF;
        }

        .step-seq-track-header[data-track="hihat"] {
            background: rgba(79, 210, 114, 0.25);
            border-left: 3px solid #4FD272;
        }

        .step-seq-track-header[data-track="perc"] {
            background: rgba(212, 95, 255, 0.22);
            border-left: 3px solid #D45FFF;
        }

        .smart-rand-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 42px;
            min-width: 42px;
            height: 42px;
            flex-shrink: 0;
            background: rgba(30, 35, 45, 0.9);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid rgba(77, 255, 255, 0.2);
        }

        .smart-rand-btn:hover {
            background: rgba(50, 55, 65, 0.9);
            box-shadow: 0 0 12px rgba(77, 255, 255, 0.4);
            border-color: #4DFFFF;
        }

        .smart-rand-btn .dice-icon {
            width: 28px;
            height: 28px;
            color: #4DFFFF;
        }

        .smart-rand-label {
            display: none;
        }

        .step-seq-track-name {
            font-size: 13px;
            font-weight: 600;
            flex: 1;
            min-width: 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Track Drag & Drop for custom audio */
        .step-seq-track-header.drag-over {
            background: rgba(77, 255, 255, 0.15) !important;
            border: 2px solid #4DFFFF !important;
            border-left: 3px solid #4DFFFF !important;
            box-shadow: 0 0 15px rgba(77, 255, 255, 0.4), inset 0 0 20px rgba(77, 255, 255, 0.1);
        }

        /* Impact Splash Effect - Internal Flash for Sample Loaded! */
        @keyframes internalFlash {
            0% {
                opacity: 0.95;
                background: linear-gradient(135deg,
                        rgba(255, 255, 255, 0.9) 0%,
                        rgba(77, 255, 255, 0.8) 30%,
                        rgba(0, 255, 200, 0.7) 60%,
                        rgba(77, 255, 255, 0.6) 100%);
            }

            15% {
                opacity: 0.7;
                background: linear-gradient(135deg,
                        rgba(77, 255, 255, 0.7) 0%,
                        rgba(255, 255, 255, 0.6) 50%,
                        rgba(77, 255, 255, 0.5) 100%);
            }

            40% {
                opacity: 0.4;
                background: linear-gradient(135deg,
                        rgba(77, 255, 255, 0.4) 0%,
                        rgba(0, 255, 200, 0.3) 100%);
            }

            100% {
                opacity: 0;
                background: transparent;
            }
        }

        @keyframes headerPulse {
            0% {
                filter: brightness(2.5) saturate(1.5);
            }

            20% {
                filter: brightness(1.8) saturate(1.3);
            }

            50% {
                filter: brightness(1.3) saturate(1.1);
            }

            100% {
                filter: brightness(1) saturate(1);
            }
        }


        /* Detail Editor - Bottom Panel */
        .detail-editor {
            background-color: var(--bg-main);
            border-radius: var(--corner-radius-lg);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            height: 100%;
            /* [DEBUG] 임시 테두리 - 디버깅용 */
            border: 2px solid red;
        }

        .edit-dock-panels-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            height: 100%;
            position: relative;
        }

        .edit-dock-panel {
            flex: 1;
            display: none;
            /* 기본 숨김 */
            flex-direction: column;
            height: 100%;
            overflow: hidden;
        }

        .edit-dock-panel.active {
            display: flex;
            /* 활성화 시 flex로 표시 */
        }

        .step-seq-track-header.impact-splash {
            animation: headerPulse 0.45s ease-out forwards;
            z-index: 10;
            position: relative;
            overflow: hidden;
        }

        /* Internal flash overlay - fills inside the header */
        .step-seq-track-header.impact-splash::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            animation: internalFlash 0.45s ease-out forwards;
            pointer-events: none;
            z-index: 100;
            mix-blend-mode: screen;
        }

        /* Subtle border highlight during flash */
        .step-seq-track-header.impact-splash::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px solid rgba(77, 255, 255, 0.8);
            border-radius: inherit;
            animation: borderFade 0.5s ease-out forwards;
            pointer-events: none;
        }

        @keyframes borderFade {
            0% {
                border-color: rgba(255, 255, 255, 0.9);
                box-shadow: inset 0 0 15px rgba(77, 255, 255, 0.5);
            }

            30% {
                border-color: rgba(77, 255, 255, 0.7);
                box-shadow: inset 0 0 10px rgba(77, 255, 255, 0.3);
            }

            100% {
                border-color: transparent;
                box-shadow: none;
            }
        }

        /* Add Track Button - Cyberpunk Kinetic Icon Button */
        .step-seq-add-track {
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            cursor: pointer;
            border-bottom: 1px solid transparent;
            padding: 0 8px;
        }

        .add-track-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            overflow: hidden;
        }

        /* Inner glow layer */
        .add-track-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at center, rgba(77, 255, 255, 0.08) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.35s ease;
            border-radius: inherit;
        }

        /* Scanning line effect */
        .add-track-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(77, 255, 255, 0.15), transparent);
            transition: left 0.6s ease;
            border-radius: inherit;
        }

        .add-track-btn:hover {
            background: rgba(77, 255, 255, 0.08);
            border-color: rgba(77, 255, 255, 0.7);
            box-shadow:
                0 0 20px rgba(77, 255, 255, 0.4),
                0 0 40px rgba(77, 255, 255, 0.2),
                inset 0 0 15px rgba(77, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .add-track-btn:hover::before {
            opacity: 1;
        }

        .add-track-btn:hover::after {
            left: 100%;
        }

        .add-track-btn:active {
            transform: scale(0.95);
            box-shadow:
                0 0 10px rgba(77, 255, 255, 0.6),
                inset 0 0 20px rgba(77, 255, 255, 0.2);
        }

        /* SVG Icon Styling */
        .add-track-icon {
            width: 16px;
            height: 16px;
            stroke: rgba(77, 255, 255, 0.7);
            stroke-width: 4;
            fill: none;
            transition: all 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            filter: drop-shadow(0 0 3px rgba(77, 255, 255, 0.4));
        }

        .add-track-btn:hover .add-track-icon {
            stroke: #4DFFFF;
            transform: rotate(90deg);
            filter: drop-shadow(0 0 8px rgba(77, 255, 255, 0.8));
        }

        .add-track-btn:active .add-track-icon {
            stroke: #ffffff;
            transform: rotate(90deg) scale(0.9);
        }

        /* ============================================ */
        /* SortableJS Drag & Drop Styles               */
        /* ============================================ */

        /* Dragging state - ghost element */
        .step-seq-track-header.sortable-ghost {
            opacity: 0.4;
            background: rgba(77, 255, 255, 0.15) !important;
            border: 1px dashed rgba(77, 255, 255, 0.6) !important;
            border-left: 3px solid #4DFFFF !important;
        }

        /* Currently being dragged element */
        .step-seq-track-header.sortable-chosen {
            box-shadow:
                0 8px 32px rgba(0, 0, 0, 0.5),
                0 0 20px rgba(77, 255, 255, 0.4),
                inset 0 0 10px rgba(77, 255, 255, 0.1);
            transform: scale(1.02);
            z-index: 1000;
            cursor: grabbing !important;
        }

        .step-seq-track-header.sortable-drag {
            opacity: 1;
            box-shadow:
                0 12px 40px rgba(0, 0, 0, 0.6),
                0 0 30px rgba(77, 255, 255, 0.5);
        }

        /* Grid row sync styles */
        .step-seq-row.sortable-ghost {
            opacity: 0.4;
            background: rgba(77, 255, 255, 0.05) !important;
        }

        .step-seq-row.sortable-chosen {
            box-shadow: 0 0 15px rgba(77, 255, 255, 0.3);
        }

        /* Smooth transition for other tracks */
        body.sorting-tracks .step-seq-track-header:not(.sortable-drag):not(.sortable-ghost) {
            transition: transform 150ms cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        body.sorting-tracks .step-seq-row:not(.sortable-drag):not(.sortable-ghost) {
            transition: transform 150ms cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        /* 트랙 헤더 드래그 커서 */
        .step-seq-track-header {
            cursor: grab;
        }

        .step-seq-track-header:active,
        .step-seq-track-header.sortable-chosen,
        .step-seq-track-header.sortable-drag {
            cursor: grabbing !important;
        }

        body.sorting-tracks,
        body.sorting-tracks * {
            cursor: grabbing !important;
        }

        /* Center - Grid Area with Inner Neon Border */
        .step-seq-grid-area {
            flex: 1;
            /* Grow to fill space */
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(77, 255, 255, 0.3);
            /* Subtler inner border */
            border-radius: 6px;
            box-shadow: 0 0 10px rgba(77, 255, 255, 0.1);
            box-shadow: 0 0 10px rgba(77, 255, 255, 0.1);
            margin: 0;
            /* Layout managed by parent gap */
            overflow-x: auto;
            overflow-y: hidden;
            width: fit-content;
            height: 100%;
            /* Fill container height */
            /* max-height: 320px; REMOVED */
        }

        /* Ruler with tick marks */
        .step-seq-ruler {
            height: 28px;
            display: flex;
            align-items: flex-end;
            background: rgba(0, 0, 0, 0.4);
            border-bottom: 1px solid rgba(77, 255, 255, 0.3);
            padding: 0 6px;
            flex-shrink: 0;
        }

        .step-seq-ruler-beat {
            display: flex;
            align-items: flex-end;
            padding-right: 8px;
            margin-right: 8px;
            border-right: 1px solid rgba(77, 255, 255, 0.2);
        }

        .step-seq-ruler-beat:last-child {
            margin-right: 0;
            padding-right: 0;
            border-right: none;
        }

        .ruler-tick {
            width: 24px;
            height: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-right: 2px;
            position: relative;
        }

        .ruler-tick:last-child {
            margin-right: 0;
        }

        .ruler-tick .beat-label {
            font-size: 11px;
            font-weight: 600;
            color: #4DFFFF;
            text-shadow: 0 0 8px rgba(77, 255, 255, 0.5);
        }

        /* Grid container */
        .step-seq-grid-scroll {
            flex: 1 1 auto;
            /* Allow shrinking to parent height */
            width: fit-content;
            overflow-x: visible;
            overflow-y: auto;
            /* Enable scroll sync with track headers */
            padding: 6px;
            position: relative;
            min-height: 0;
            /* Allow flex item to shrink and enable overflow */
            scrollbar-width: none;
            /* Firefox */
            -ms-overflow-style: none;
            /* IE/Edge */
        }

        .step-seq-grid-scroll::-webkit-scrollbar {
            display: none;
            /* Chrome/Safari/Opera */
        }

        /* Wave Visualizer - SVG Fluid Wave */
        .wave-visualizer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0.5;
            overflow: hidden;
        }

        #wave-svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.4));
        }

        .wave-visualizer.playing #wave-svg {
            filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.6));
        }

        .step-seq-grid {
            display: flex;
            flex-direction: column;
            gap: 0;
            position: relative;
            z-index: 1;
            width: fit-content;
        }

        .step-seq-row {
            height: 56px;
            min-height: 56px;
            /* Prevent shrinking */
            flex-shrink: 0;
            /* Never shrink in flex container */
            display: flex;
            align-items: center;
            gap: 0;
            position: relative;
            margin-bottom: 4px;
            /* Match .step-seq-track-header margin-bottom */
        }

        .step-seq-row:last-child {
            margin-bottom: 0;
        }

        /* Beat group with separator */
        .step-beat-group {
            display: flex;
            gap: 2px;
            padding-right: 8px;
            margin-right: 8px;
            border-right: 1px solid rgba(77, 255, 255, 0.2);
            position: relative;
        }

        .step-beat-group:last-child {
            margin-right: 0;
            padding-right: 0;
            border-right: none;
        }

        /* Step cell - double border structure */
        .step-cell {
            width: 24px;
            height: 48px;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.15s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            /* Outer border */
            border: 2px solid transparent;
            /* Inner border via box-shadow */
            box-shadow: inset 0 0 0 1px rgba(128, 128, 128, 0.25);
        }

        /* Inactive step - double border structure (outer + inner) */
        .step-seq-row[data-color="#FF6B6B"] .step-cell {
            border: 1px solid rgba(255, 107, 107, 0.35);
            box-shadow: inset 0 0 0 1px rgba(255, 107, 107, 0.15);
        }

        .step-seq-row[data-color="#4DFFFF"] .step-cell {
            border: 1px solid rgba(77, 255, 255, 0.35);
            box-shadow: inset 0 0 0 1px rgba(77, 255, 255, 0.15);
        }

        .step-seq-row[data-color="#4FD272"] .step-cell {
            border: 1px solid rgba(79, 210, 114, 0.35);
            box-shadow: inset 0 0 0 1px rgba(79, 210, 114, 0.15);
        }

        .step-seq-row[data-color="#D45FFF"] .step-cell {
            border: 1px solid rgba(212, 95, 255, 0.35);
            box-shadow: inset 0 0 0 1px rgba(212, 95, 255, 0.15);
        }

        .step-cell:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        /* Active step - Neon glow style with inner border */
        .step-seq-row[data-color="#FF6B6B"] .step-cell.active {
            background: rgba(255, 107, 107, 0.3);
            border: 2px solid #FF6B6B;
            box-shadow: 0 0 12px #FF6B6B, 0 0 20px rgba(255, 107, 107, 0.4), inset 0 0 0 3px rgba(0, 0, 0, 0.3), inset 0 0 0 4px rgba(255, 107, 107, 0.6);
        }

        .step-seq-row[data-color="#4DFFFF"] .step-cell.active {
            background: rgba(77, 255, 255, 0.3);
            border: 2px solid #4DFFFF;
            box-shadow: 0 0 12px #4DFFFF, 0 0 20px rgba(77, 255, 255, 0.4), inset 0 0 0 3px rgba(0, 0, 0, 0.3), inset 0 0 0 4px rgba(77, 255, 255, 0.6);
        }

        .step-seq-row[data-color="#4FD272"] .step-cell.active {
            background: rgba(79, 210, 114, 0.3);
            border: 2px solid #4FD272;
            box-shadow: 0 0 12px #4FD272, 0 0 20px rgba(79, 210, 114, 0.4), inset 0 0 0 3px rgba(0, 0, 0, 0.3), inset 0 0 0 4px rgba(79, 210, 114, 0.6);
        }

        .step-seq-row[data-color="#D45FFF"] .step-cell.active {
            background: rgba(212, 95, 255, 0.3);
            border: 2px solid #D45FFF;
            box-shadow: 0 0 12px #D45FFF, 0 0 20px rgba(212, 95, 255, 0.4), inset 0 0 0 3px rgba(0, 0, 0, 0.3), inset 0 0 0 4px rgba(212, 95, 255, 0.6);
        }

        /* Ghost step */
        .step-seq-row[data-color="#FF6B6B"] .step-cell.ghost {
            background: rgba(255, 107, 107, 0.08);
            box-shadow: inset 0 0 0 1px rgba(255, 107, 107, 0.3);
        }

        .step-seq-row[data-color="#4DFFFF"] .step-cell.ghost {
            background: rgba(77, 255, 255, 0.08);
            box-shadow: inset 0 0 0 1px rgba(77, 255, 255, 0.3);
        }

        .step-seq-row[data-color="#4FD272"] .step-cell.ghost {
            background: rgba(79, 210, 114, 0.08);
            box-shadow: inset 0 0 0 1px rgba(79, 210, 114, 0.3);
        }

        .step-seq-row[data-color="#D45FFF"] .step-cell.ghost {
            background: rgba(212, 95, 255, 0.08);
            box-shadow: inset 0 0 0 1px rgba(212, 95, 255, 0.3);
        }

        /* Ratchet label */
        .ratchet-label {
            position: absolute;
            top: 3px;
            font-size: 9px;
            font-weight: 700;
            color: #fff;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
        }

        /* Custom scrollbar for grid */
        .step-seq-grid-scroll::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .step-seq-grid-scroll::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }

        .step-seq-grid-scroll::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #4DFFFF, #3AC9C9);
            border-radius: 4px;
        }

        .step-seq-grid-scroll::-webkit-scrollbar-corner {
            background: rgba(0, 0, 0, 0.3);
        }

        /* Current Step Highlight (Playing Position) */
        .step-cell.current {
            position: relative;
        }

        .step-cell.current::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            animation: stepPulse 0.2s ease-out;
            pointer-events: none;
        }

        @keyframes stepPulse {
            0% {
                transform: scale(1.2);
                opacity: 1;
            }

            100% {
                transform: scale(1);
                opacity: 0.6;
            }
        }

        /* Current step with neon wave effect per track color */
        .step-seq-row[data-color="#FF6B6B"] .step-cell.current::before {
            border-color: #FF6B6B;
            box-shadow: 0 0 15px #FF6B6B, 0 0 30px rgba(255, 107, 107, 0.5);
        }

        .step-seq-row[data-color="#4DFFFF"] .step-cell.current::before {
            border-color: #4DFFFF;
            box-shadow: 0 0 15px #4DFFFF, 0 0 30px rgba(77, 255, 255, 0.5);
        }

        .step-seq-row[data-color="#4FD272"] .step-cell.current::before {
            border-color: #4FD272;
            box-shadow: 0 0 15px #4FD272, 0 0 30px rgba(79, 210, 114, 0.5);
        }

        .step-seq-row[data-color="#D45FFF"] .step-cell.current::before {
            border-color: #D45FFF;
            box-shadow: 0 0 15px #D45FFF, 0 0 30px rgba(212, 95, 255, 0.5);
        }

        /* Edit Dock Focus State */
        .edit-dock-tab.focused {
            background: rgba(0, 255, 255, 0.15);
            border-color: var(--neon-cyan);
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
        }

        /* Right - Control Panel */
        .step-seq-controls {
            width: 90px;
            min-width: 90px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px 5px;
            gap: 10px;
        }

        /* Kit Selector Dropdown */
        .kit-selector {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 3px;
            min-height: 55px;
            max-height: 55px;
        }

        .kit-select {
            background: rgba(30, 30, 30, 0.9);
            border: 1px solid rgba(77, 255, 255, 0.3);
            border-radius: 4px;
            color: #4DFFFF;
            font-size: 9px;
            font-weight: 600;
            padding: 3px 4px;
            cursor: pointer;
            width: 80px;
            max-width: 80px;
            transition: all 0.2s ease;
            text-overflow: ellipsis;
            overflow: hidden;
        }

        .kit-select:hover {
            border-color: #4DFFFF;
            box-shadow: 0 0 8px rgba(77, 255, 255, 0.3);
        }

        .kit-select:focus {
            outline: none;
            border-color: #4DFFFF;
            box-shadow: 0 0 12px rgba(77, 255, 255, 0.4);
        }

        .kit-select option {
            background: #1a1a1a;
            color: #ccc;
            padding: 8px 10px;
            text-align: left;
            font-size: 12px;
        }

        .kit-select option:hover,
        .kit-select option:focus {
            background: #2a2a2a;
            color: #fff;
        }

        .kit-select option:checked {
            background: linear-gradient(0deg, #2a3a3a 0%, #1a2a2a 100%);
            color: #4DFFFF;
        }

        .kit-select optgroup {
            background: #0d0d0d;
            color: #888;
            font-weight: 600;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 6px 8px;
            text-align: left;
        }

        .kit-label {
            font-size: 9px;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 1px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100px;
            text-align: center;
            height: 12px;
            line-height: 12px;
        }

        .kit-select.loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .kit-morph-btn {
            width: 70px;
            height: 60px;
            background: transparent;
            border: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            --morph-color: #4DFFFF;
        }

        .kit-morph-btn:hover .morph-icon {
            color: #fff;
            filter: drop-shadow(0 0 10px var(--morph-color)) drop-shadow(0 0 20px var(--morph-color));
        }

        .kit-morph-btn:hover .kit-morph-label {
            color: #fff;
            text-shadow: 0 0 10px var(--morph-color), 0 0 20px var(--morph-color), 0 0 30px var(--morph-color);
        }

        .kit-morph-btn .morph-icon {
            width: 28px;
            height: 28px;
            color: var(--morph-color);
            transition: all 0.3s ease;
        }

        .kit-morph-label {
            font-size: 10px;
            color: var(--morph-color);
            margin-top: 3px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        /* Kit Morph ?성???니메이??*/
        .kit-morph-btn.morphing .morph-icon {
            animation: morphSpin 0.5s ease-out;
        }

        @keyframes morphSpin {
            0% {
                transform: rotate(0deg) scale(1);
            }

            50% {
                transform: rotate(180deg) scale(1.2);
            }

            100% {
                transform: rotate(360deg) scale(1);
            }
        }

        .kit-morph-btn.morphing .morph-icon,
        .kit-morph-btn.morphing .kit-morph-label {
            color: var(--morph-color);
            filter: drop-shadow(0 0 15px var(--morph-color)) drop-shadow(0 0 30px var(--morph-color));
        }

        /* Humanize Control - 가로형 슬라이더 */
        .humanize-control {
            display: flex;
            flex-direction: column;
            align-items: stretch;
            gap: 4px;
            width: 100%;
            padding: 6px 8px;
        }

        .humanize-slider-container {
            display: flex;
            flex-direction: column;
            align-items: stretch;
            gap: 4px;
            width: 100%;
        }

        /* Custom Range Slider Styling */
        .humanize-slider-input {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 6px;
            background: rgba(30, 35, 45, 0.9);
            border-radius: 3px;
            border: 1px solid rgba(77, 255, 255, 0.2);
            cursor: pointer;
            outline: none;
            transition: all 0.15s ease;
        }

        .humanize-slider-input:hover {
            border-color: rgba(77, 255, 255, 0.5);
            box-shadow: 0 0 8px rgba(77, 255, 255, 0.2);
        }

        /* Webkit (Chrome, Safari) - Slider Thumb */
        .humanize-slider-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            background: linear-gradient(135deg, #4DFFFF, #3AC9C9);
            border-radius: 50%;
            border: 2px solid rgba(77, 255, 255, 0.8);
            cursor: pointer;
            box-shadow: 0 0 8px rgba(77, 255, 255, 0.5);
            transition: all 0.15s ease;
        }

        .humanize-slider-input::-webkit-slider-thumb:hover {
            transform: scale(1.15);
            box-shadow: 0 0 12px rgba(77, 255, 255, 0.8);
        }

        /* Firefox - Slider Thumb */
        .humanize-slider-input::-moz-range-thumb {
            width: 14px;
            height: 14px;
            background: linear-gradient(135deg, #4DFFFF, #3AC9C9);
            border-radius: 50%;
            border: 2px solid rgba(77, 255, 255, 0.8);
            cursor: pointer;
            box-shadow: 0 0 8px rgba(77, 255, 255, 0.5);
        }

        /* Firefox - Slider Track */
        .humanize-slider-input::-moz-range-track {
            background: rgba(30, 35, 45, 0.9);
            border-radius: 3px;
            height: 6px;
        }

        .humanize-info {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 4px;
        }

        .humanize-label {
            font-size: 0.75rem;
            color: #9BA3B0;
            font-weight: 500;
        }

        .humanize-value {
            font-size: 0.75rem;
            color: #4DFFFF;
            font-weight: 600;
        }

        .step-count-toggle {
            align-self: flex-end;
            /* Align to bottom of container */
            margin-left: 20px;
            /* Left spacing (Force separation) */
            margin-bottom: 2px;
            /* Fine-tune specific alignment */
            z-index: 100;
            padding: 4px 8px;
            /* Compact padding */
            background: rgba(79, 210, 114, 0.1);
            border: 1px solid rgba(79, 210, 114, 0.4);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .step-count-toggle:hover {
            background: rgba(79, 210, 114, 0.2);
            box-shadow: 0 0 20px rgba(79, 210, 114, 0.4);
            transform: translateY(-1px);
        }

        .step-count-toggle .step-count-value {
            font-size: 0.9rem;
            /* Reduced from default */
            font-weight: 800;
            color: #4FD272;
            transition: all 0.2s ease;
            line-height: 1;
            text-shadow: 0 0 8px rgba(79, 210, 114, 0.5);
        }

        .step-count-toggle .step-count-label {
            font-size: 10px;
            /* Enlarged */
            color: #4FD272;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.8;
        }

        /* 32 Steps expanded state - 같�? ?�안???��? */
        .step-count-toggle.expanded .step-count-value {
            color: #4DFFFF;
        }

        .step-count-toggle.expanded .step-count-label {
            color: #4DFFFF;
        }

        /* Step cell expansion animation */
        .step-seq-grid-scroll {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .step-seq-grid-scroll.expanded {
            /* 32?�텝?�로 ?�장 ???�크�??�역 ?�장 */
        }

        .step-cell {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* 32 ?�텝 모드 - ?� ?�기 ?��?, ?�크롤로 ?�장 */
        .step-seq-grid.steps-32 {
            /* ?� ?�기 ?��? - ?�크롤로 처리 */
        }

        /* ??beat-group 추�? ?�니메이??*/
        .step-beat-group.new-beat-group {
            animation: beatGroupAppear 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            transform-origin: left center;
        }

        @keyframes beatGroupAppear {
            0% {
                opacity: 0;
                transform: scaleX(0);
            }

            100% {
                opacity: 1;
                transform: scaleX(1);
            }
        }

        /* ??ruler-beat 추�? ?�니메이??*/
        .step-seq-ruler-beat.new-beat {
            animation: beatGroupAppear 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            transform-origin: left center;
        }

        /* beat-group/ruler-beat ?�거 ?�니메이??*/
        .step-beat-group.removing,
        .step-seq-ruler-beat.removing {
            animation: beatGroupRemove 0.2s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            transform-origin: left center;
        }

        @keyframes beatGroupRemove {
            0% {
                opacity: 1;
                transform: scaleX(1);
            }

            100% {
                opacity: 0;
                transform: scaleX(0);
            }
        }

        /* 그리???�장/축소 ?�랜지??*/
        .step-seq-row {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .step-seq-ruler {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ==================== End Step Sequencer Styles ==================== */

        /* ==================== Mixer Panel Styles (FL Studio Style) ==================== */
        .mixer-wrapper {
            flex: 1;
            display: flex;
            background: #1A1A20;
            padding: 10px;
            height: 100%;
            min-height: 0;
        }

        .mixer-content {
            flex: 1;
            background: rgba(15, 20, 30, 0.9);
            border: 2px solid #4DFFFF;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(77, 255, 255, 0.4), inset 0 0 30px rgba(0, 0, 0, 0.5);
            display: flex !important;
            min-height: 300px !important;
            align-items: stretch;
            padding: 10px 12px;
            overflow-x: auto;
            overflow-y: hidden;
            gap: 4px;
        }

        .mixer-content::-webkit-scrollbar {
            height: 8px;
        }

        .mixer-content::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }

        .mixer-content::-webkit-scrollbar-thumb {
            background: linear-gradient(90deg, #4DFFFF, #3AC9C9);
            border-radius: 4px;
        }

        /* Channel Strip - FL Studio Style (Slim) */
        .channel-strip {
            width: 52px;
            min-width: 52px;
            height: 100%;
            background: linear-gradient(180deg, rgba(40, 45, 55, 0.95), rgba(28, 32, 40, 0.95));
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0;
            position: relative;
            flex-shrink: 0;
            border: 1px solid rgba(77, 255, 255, 0.1);
            transition: all 0.2s ease;
            overflow: visible;
        }

        .channel-strip:hover {
            border-color: rgba(77, 255, 255, 0.4);
            box-shadow: 0 0 12px rgba(77, 255, 255, 0.15);
        }

        .channel-strip.selected {
            border-color: rgba(77, 255, 255, 0.6);
            box-shadow: 0 0 15px rgba(77, 255, 255, 0.3), inset 0 0 20px rgba(77, 255, 255, 0.05);
        }

        .channel-strip.master-strip {
            width: 58px;
            min-width: 58px;
            background: linear-gradient(180deg, rgba(50, 45, 35, 0.95), rgba(35, 32, 25, 0.95));
            border-color: rgba(255, 215, 0, 0.25);
        }

        .channel-strip.master-strip:hover {
            border-color: rgba(255, 215, 0, 0.5);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.2);
        }

        .channel-strip.master-strip.selected {
            border-color: rgba(255, 215, 0, 0.7);
            box-shadow: 0 0 18px rgba(255, 215, 0, 0.4), inset 0 0 20px rgba(255, 215, 0, 0.05);
        }

        /* Track Name Header (?�로 ?�스??+ 컬러�? */
        .mixer-track-header {
            width: 100%;
            height: 70px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            position: relative;
            padding-top: 4px;
        }

        .mixer-color-bar {
            width: 100%;
            height: 3px;
            margin-bottom: 6px;
        }

        .mixer-track-name-vertical {
            writing-mode: vertical-rl;
            text-orientation: mixed;
            transform: rotate(180deg);
            font-size: 10px;
            font-weight: 600;
            color: #ddd;
            letter-spacing: 1px;
            text-transform: uppercase;
            max-height: 55px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Control Buttons Row */
        .mixer-controls-row {
            display: flex;
            gap: 4px;
            padding: 4px 0;
        }

        .btn-mixer-ctrl {
            width: 20px;
            height: 18px;
            font-size: 10px;
            font-weight: 700;
            background: transparent;
            color: #555;
            border: 1px solid #444;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-mixer-ctrl:hover {
            border-color: #666;
            color: #888;
        }

        .btn-mixer-ctrl.active-mute {
            background: transparent;
            color: #FFB800;
            border-color: #FFB800;
            box-shadow: 0 0 8px rgba(255, 184, 0, 0.6), 0 0 16px rgba(255, 184, 0, 0.3);
            text-shadow: 0 0 8px #FFB800;
        }

        .btn-mixer-ctrl.active-solo {
            background: transparent;
            color: #4FD272;
            border-color: #4FD272;
            box-shadow: 0 0 8px rgba(79, 210, 114, 0.6), 0 0 16px rgba(79, 210, 114, 0.3);
            text-shadow: 0 0 8px #4FD272;
        }

        /* Fader + Level Meter Area (FL Studio Core) */
        .mixer-fader-section {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: stretch;
            gap: 3px;
            padding: 6px 2px;
            width: 100%;
            overflow: visible;
        }

        /* Level Meter (?�로 �? */
        .level-meter {
            width: 6px;
            height: 100%;
            background: #1a1a20;
            border-radius: 2px;
            position: relative;
            overflow: hidden;
            border: 1px solid #333;
        }

        .level-meter-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(to top,
                    #FF00FF 0%,
                    #AA00FF 35%,
                    #8B00FF 55%,
                    #00CCFF 80%,
                    #00FFFF 100%);
            border-radius: 1px;
            transition: height 0.1s ease;
            box-shadow: 0 0 6px rgba(170, 0, 255, 0.5);
        }

        /* Fader (중앙) */
        .mixer-fader-track {
            width: 6px;
            height: 100%;
            background: linear-gradient(180deg, #252530, #1a1a20);
            border-radius: 3px;
            position: relative;
            border: 1px solid #3a3a45;
            overflow: visible;
        }

        .mixer-fader-thumb {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 22px;
            height: 18px;
            background: linear-gradient(180deg, #666, #444);
            border-radius: 2px;
            cursor: grab;
            border: 1px solid #888;
            box-shadow: 0 0 6px var(--fader-color, rgba(77, 255, 255, 0.3));
            z-index: 5;
        }

        .mixer-fader-thumb::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 16px;
            height: 1px;
            background: var(--fader-color, #4DFFFF);
            box-shadow: 0 -3px 0 var(--fader-color, #4DFFFF), 0 3px 0 var(--fader-color, #4DFFFF);
            opacity: 0.9;
        }

        /* Volume Display */
        .mixer-vol-display {
            width: 100%;
            text-align: center;
            padding: 4px 0 6px 0;
            font-size: 9px;
            font-family: 'Consolas', monospace;
            color: #4DFFFF;
            background: rgba(0, 0, 0, 0.3);
        }

        .master-strip .mixer-vol-display {
            color: #FFD700;
        }

        /* Separator */
        .mixer-separator {
            width: 1px;
            height: 100%;
            background: linear-gradient(180deg, transparent 5%, rgba(255, 215, 0, 0.3) 50%, transparent 95%);
            margin: 0 4px;
            flex-shrink: 0;
        }

        /* Master specific */
        .master-strip .mixer-track-name-vertical {
            color: #FFD700;
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
        }

        /* FX Channel */
        .fx-strip {
            background: linear-gradient(180deg, rgba(60, 40, 50, 0.95), rgba(40, 28, 35, 0.95));
            border-color: rgba(255, 107, 157, 0.2);
        }

        .fx-strip:hover {
            border-color: rgba(255, 107, 157, 0.5);
            box-shadow: 0 0 12px rgba(255, 107, 157, 0.2);
        }

        .fx-strip.selected {
            border-color: rgba(255, 107, 157, 0.7);
            box-shadow: 0 0 15px rgba(255, 107, 157, 0.4), inset 0 0 20px rgba(255, 107, 157, 0.05);
        }

        .fx-strip .mixer-track-name-vertical {
            color: #FF6B9D;
            text-shadow: 0 0 6px rgba(255, 107, 157, 0.5);
        }

        /* Group Channel */
        .group-strip {
            background: linear-gradient(180deg, rgba(30, 50, 60, 0.95), rgba(20, 35, 45, 0.95));
            border-color: rgba(0, 191, 255, 0.2);
        }

        .group-strip:hover {
            border-color: rgba(0, 191, 255, 0.5);
            box-shadow: 0 0 12px rgba(0, 191, 255, 0.2);
        }

        .group-strip.selected {
            border-color: rgba(0, 191, 255, 0.7);
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.4), inset 0 0 20px rgba(0, 191, 255, 0.05);
        }

        .group-strip .mixer-track-name-vertical {
            color: #00BFFF;
            text-shadow: 0 0 6px rgba(0, 191, 255, 0.5);
        }

        /* AI Smart Knob */
        .smart-knob-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 4px 0;
            margin-bottom: 2px;
        }

        .smart-knob {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #3a3a45, #1a1a20);
            border: 2px solid #444;
            position: relative;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .smart-knob:hover {
            border-color: var(--knob-color, #4DFFFF);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5), 0 0 10px var(--knob-color, rgba(77, 255, 255, 0.3));
        }

        .smart-knob.active {
            border-color: var(--knob-color, #4DFFFF);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5), 0 0 12px var(--knob-color, rgba(77, 255, 255, 0.5));
        }

        .smart-knob-indicator {
            position: absolute;
            top: 3px;
            left: 50%;
            width: 2px;
            height: 8px;
            background: #555;
            transform-origin: bottom center;
            transform: translateX(-50%) rotate(var(--knob-rotation, 0deg));
            border-radius: 1px;
            transition: background 0.2s ease;
        }

        .smart-knob:hover .smart-knob-indicator,
        .smart-knob.active .smart-knob-indicator {
            background: var(--knob-color, #4DFFFF);
            box-shadow: 0 0 4px var(--knob-color, #4DFFFF);
        }

        .smart-knob-label {
            font-size: 7px;
            font-weight: 700;
            color: #666;
            margin-top: 3px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.2s ease;
        }

        .smart-knob-wrapper:hover .smart-knob-label {
            color: var(--knob-color, #4DFFFF);
            text-shadow: 0 0 6px var(--knob-color, rgba(77, 255, 255, 0.5));
        }

        .smart-knob.active+.smart-knob-label {
            color: var(--knob-color, #4DFFFF);
            text-shadow: 0 0 6px var(--knob-color, rgba(77, 255, 255, 0.5));
        }

        /* Smart Knob Value Display (on hover) */
        .smart-knob-value {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 9px;
            font-weight: 600;
            color: var(--knob-color, #4DFFFF);
            background: rgba(0, 0, 0, 0.8);
            padding: 2px 5px;
            border-radius: 3px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
            white-space: nowrap;
        }

        .smart-knob-wrapper:hover .smart-knob-value {
            opacity: 1;
        }

        /* ==================== End Mixer Panel Styles ==================== */

        .editor-content {
            flex: 1;
            display: flex;
            justify-content: center;
            /* Center the group (Sequencer + Global) */
            align-items: flex-start;
            /* Ensure top alignment if height differs */
            gap: 0;
            /* Tight fit */
            overflow: hidden;
            height: 100%;
            min-height: 0;
        }

        /* AI Modifier Panel */
        .ai-modifier {
            width: 120px;
            background: #252830;
            padding: 12px;
            border-right: 1px solid #2A2D33;
            flex-shrink: 0;
        }

        .modifier-title {
            color: var(--neon-cyan);
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .slider-group {
            margin-bottom: 12px;
        }

        .slider-label {
            color: var(--text-muted);
            font-size: 10px;
            margin-bottom: 4px;
        }

        .slider-bar {
            height: 6px;
            background: #1A1A20;
            border-radius: 3px;
            overflow: hidden;
        }

        .slider-fill {
            height: 100%;
            background: var(--track-bass);
            border-radius: 3px;
        }

        /* Piano Roll Container */
        .piano-roll {
            flex: 1;
            display: flex !important;
            flex-direction: column;
            overflow: hidden;
            height: 100% !important;
            min-height: 300px !important;
        }

        /* Piano Roll Time Ruler */
        .piano-roll-ruler {
            height: 24px;
            display: flex;
            background: #1A1A20;
            border-bottom: 1px solid #3A3D45;
            flex-shrink: 0;
        }

        .piano-roll-ruler-corner {
            width: 65px;
            background: #1A1A20;
            border-right: 1px solid #2A2D33;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .midi-clip-name {
            font-size: 9px;
            color: #E85D5D;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .piano-roll-ruler-content {
            flex: 1;
            position: relative;
            overflow: hidden;
            background:
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 24px,
                    #252830 24px,
                    #252830 25px),
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 99px,
                    #3A3D45 99px,
                    #3A3D45 100px);
        }

        .piano-roll-bar-marker {
            position: absolute;
            top: 4px;
            font-size: 10px;
            font-weight: 500;
            color: #808590;
        }

        .piano-roll-bar-marker .bar-beat {
            color: #606570;
            margin-left: 2px;
        }

        .piano-roll-beat-marker {
            position: absolute;
            top: 4px;
            font-size: 9px;
            color: #505560;
        }

        /* Piano Roll Body */
        .piano-roll-body {
            flex: 1;
            display: flex !important;
            overflow: hidden;
            min-height: 260px !important;
        }

        /* Piano Keys - Cubase Style (Real Piano Layout) */
        .piano-keys {
            width: 65px;
            background: #1A1A20;
            flex-shrink: 0;
            position: relative;
            border-right: 1px solid #2A2D33;
            overflow: hidden;
        }

        /* White keys - full height, sequential */
        .piano-key-white {
            position: absolute;
            left: 0;
            width: 100%;
            background: linear-gradient(90deg, #909090 0%, #C8C8C8 40%, #E0E0E0 60%, #D0D0D0 100%);
            border-bottom: 1px solid #707070;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 3px;
            font-size: 8px;
            color: #404040;
            box-sizing: border-box;
            z-index: 1;
        }

        .piano-key-white.c-key {
            font-weight: bold;
        }

        /* Black keys - shorter, overlay on white keys */
        .piano-key-black {
            position: absolute;
            left: 0;
            width: 65%;
            background: linear-gradient(90deg, #101010 0%, #252525 50%, #1A1A1A 100%);
            border-radius: 0 2px 2px 0;
            box-shadow: 2px 0 3px rgba(0, 0, 0, 0.5);
            z-index: 2;
        }

        /* MIDI Grid Area */
        .midi-grid-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .midi-grid {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: #252830;
        }

        /* Grid Lines */
        .midi-grid-lines {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            background:
                /* Bar lines (100px) - bright */
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 99px,
                    #404550 99px,
                    #404550 100px),
                /* Beat lines (25px) - subtle */
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 24px,
                    #2A2D35 24px,
                    #2A2D35 25px);
        }

        /* Horizontal row backgrounds for piano keys - Cubase Style */
        .midi-grid-rows {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }

        .midi-row {
            position: absolute;
            left: 0;
            right: 0;
            height: 14px;
            border-bottom: 1px solid #1E2028;
        }

        .midi-row.white-key {
            background: #2A2D35;
        }

        .midi-row.black-key {
            background: #1E2128;
        }

        .midi-row.c-row {
            border-bottom: 1px solid #3A3D45;
        }

        /* MIDI Notes - Cubase Red Style */
        .midi-note {
            position: absolute;
            height: 14px;
            background: linear-gradient(180deg, #E85D5D 0%, #C94545 100%);
            border-radius: 2px;
            border: 1px solid #FF7070;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            display: flex;
            align-items: center;
            padding-left: 4px;
            font-size: 9px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
            overflow: hidden;
        }

        .midi-note:hover {
            background: linear-gradient(180deg, #FF6B6B 0%, #D55050 100%);
            border-color: #FF8080;
        }

        .midi-note.selected {
            background: linear-gradient(180deg, #FF7070 0%, #E05555 100%);
            border-color: #FFAAAA;
            box-shadow: 0 0 6px rgba(255, 100, 100, 0.5);
        }

        /* Velocity Lane - Cubase Style (Below Piano Roll) */
        .velocity-section {
            height: 70px;
            background: #1A1A20;
            border-top: 1px solid #3A3D45;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .velocity-lane {
            flex: 1;
            display: flex;
            background: #1A1A20;
        }

        .velocity-header {
            width: 65px;
            display: flex;
            flex-direction: column;
            background: #1A1A20;
            border-right: 1px solid #2A2D33;
        }

        .velocity-label-area {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: var(--text-muted);
        }

        .velocity-grid {
            flex: 1;
            position: relative;
            background:
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 99px,
                    #2A2D35 99px,
                    #2A2D35 100px),
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 24px,
                    #1F2228 24px,
                    #1F2228 25px),
                #1A1A20;
        }

        .velocity-max-label {
            width: 35px;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding-top: 4px;
            font-size: 10px;
            color: #606570;
            background: #1A1A20;
        }

        .velocity-bar {
            position: absolute;
            bottom: 0;
            width: 6px;
            background: linear-gradient(180deg, #E85D5D 0%, #B84040 100%);
            border-radius: 1px 1px 0 0;
        }

        /* Velocity Bottom Controls - Cubase Style */
        .velocity-bottom-bar {
            height: 22px;
            display: flex;
            background: #252830;
            border-top: 1px solid #2A2D33;
        }

        .velocity-controls-left {
            width: 65px;
            display: flex;
            align-items: center;
            padding: 0 4px;
            gap: 4px;
            border-right: 1px solid #2A2D33;
        }

        .velocity-add-btn {
            width: 18px;
            height: 16px;
            background: #3A3D45;
            border: 1px solid #4A4D55;
            border-radius: 2px;
            color: #909090;
            font-size: 14px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .velocity-add-btn:hover {
            background: #4A4D55;
            color: #C0C0C0;
        }

        .velocity-dropdown-btn {
            width: 18px;
            height: 16px;
            background: #3A3D45;
            border: 1px solid #4A4D55;
            border-radius: 2px;
            color: #909090;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .velocity-dropdown-btn:hover {
            background: #4A4D55;
            color: #C0C0C0;
        }

        /* Piano Roll Scrollbar - Cubase Style */
        .piano-roll-scrollbar {
            flex: 1;
            display: flex;
            align-items: center;
            padding: 0 8px;
            background: #1A1A1E;
        }

        .piano-roll-scroll-track {
            flex: 1;
            height: 10px;
            background: #101015;
            border-radius: 2px;
            position: relative;
        }

        .piano-roll-scroll-thumb {
            position: absolute;
            left: 10%;
            width: 25%;
            height: 100%;
            background: linear-gradient(180deg, #5A5A62 0%, #3A3A42 100%);
            border-radius: 2px;
            border: 1px solid #6A6A72;
            cursor: grab;
        }

        .piano-roll-scroll-thumb:hover {
            background: linear-gradient(180deg, #6A6A72 0%, #4A4A52 100%);
        }

        /* Piano Roll Playhead - Neon Cyan */
        .piano-roll-playhead {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 1px;
            background: #00FFFF;
            z-index: 50;
            pointer-events: none;
            box-shadow: 0 0 4px #00FFFF,
                0 0 8px rgba(0, 255, 255, 0.6),
                0 0 12px rgba(0, 255, 255, 0.3);
        }

        .piano-roll-playhead::before {
            content: '';
            position: absolute;
            top: -24px;
            left: -4px;
            border-left: 4px solid transparent;
            border-right: 4px solid transparent;
            border-top: 7px solid #00FFFF;
            filter: drop-shadow(0 0 4px #00FFFF);
        }

        /* AI Copilot (Right Sidebar) */
        .ai-copilot {
            background-color: var(--bg-main);
            display: flex;
            flex-direction: column;
            padding: 0 15px 15px 15px;
            border-radius: var(--corner-radius-lg);
        }

        .copilot-title {
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2.5px;
            color: #5A5D65;
            text-shadow:
                0 1px 0 rgba(200, 205, 215, 0.5),
                0 -1px 0 rgba(0, 0, 0, 0.7);
            text-align: center;
            padding: 6px 0;
            border-bottom: 1px solid #2A2D33;
            margin-bottom: 15px;
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
        }

        .chat-bubble {
            border-radius: var(--corner-radius);
            padding: 12px;
            margin-bottom: 10px;
            font-size: 12px;
        }

        .chat-bubble.user {
            background: var(--chat-user);
        }

        .chat-bubble.ai {
            background: var(--chat-ai);
        }

        .chat-sender {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .chat-input-area {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .chat-input {
            flex: 1;
            background: var(--bg-input);
            border: 1px solid var(--bg-panel);
            border-radius: var(--corner-radius);
            color: var(--text-main);
            padding: 10px;
            font-size: 12px;
        }

        .chat-input::placeholder {
            color: var(--text-muted);
        }

        .send-btn {
            background: var(--neon-cyan);
            border: none;
            color: var(--bg-main);
            width: 35px;
            height: 35px;
            border-radius: var(--corner-radius);
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }

        /* Fix for Piano Roll and Mixer Panel Content Visibility */
        /* 기본적으로 모든 패널은 숨김 */
        .edit-dock-panel {
            display: none !important;
            flex: 1;
            height: 100%;
            min-height: 0;
            overflow: hidden;
        }

        /* active 클래스가 있을 때만 표시 */
        .edit-dock-panel.active {
            display: flex !important;
            flex-direction: row;
            /* Side by side layout for Sequencer + Global */
            gap: 10px;
        }

        /* 내부 콘텐츠가 꽉 차도록 설정 */
        .edit-dock-panel[data-panel="piano-roll"] .piano-roll,
        .edit-dock-panel[data-panel="mixer"] .mixer-wrapper {
            display: flex;
            flex: 1;
            height: 100%;
            width: 100%;
            min-height: 0;
            overflow: hidden;
        }

        /* Ensure content inside is visible */
        .piano-roll-body,
        .mixer-content {
            /* visibility: visible !important;  <-- 제거: 부모가 display:none이면 어차피 안보임 */
            /* opacity: 1 !important;           <-- 제거 */
        }

        /* Remove debug border safely */
        .detail-editor {
            border: none !important;
        }

        /* ==================== 3-Column Layout Fix (Step Sequencer) ==================== */
        .step-seq-tab-container {
            display: flex;
            height: 100%;
            width: 100%;
            overflow: hidden;
            background: #1A1A20;
        }

        .wing-panel.global-panel {
            margin-left: 0;
            border-left: 1px solid #2A2D33;
            border-right: none;
        }

        .wing-panel {
            width: 340px;
            /* Expanded Width */
            min-width: 340px;
            height: 100%;
            background: #16161C;
            border-right: 1px solid #2A2D33;
            display: flex;
            flex-direction: column;
            padding: 12px;
            /* Reduced Padding */
            gap: 15px;
            /* Gap between boxes */
            overflow: hidden;
            /* No global scroll */
            flex-shrink: 0;
            z-index: 10;
        }

        /* Inspiration Hub Box Styles */
        .inspiration-header-row {
            display: flex;
            gap: 10px;
            height: 90px;
            flex-shrink: 0;
            margin-bottom: 0;
            /* Align tightly */
        }

        .mini-box {
            flex: 1;
            background: #1A1A20;
            border: 1px solid #333;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        .mini-box-label {
            height: 24px;
            background: #252830;
            border-bottom: 1px solid #333;
            font-size: 11px;
            font-weight: 700;
            color: #ccc;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .kit-dropdown-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 5px;
        }

        .kit-select-compact {
            width: 90%;
            background: #111;
            color: #fff;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 4px;
            font-size: 11px;
        }

        .samples-trigger-btn {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #888;
            cursor: pointer;
            transition: all 0.2s;
        }

        .samples-trigger-btn:hover {
            color: #fff;
            background: rgba(255, 255, 255, 0.05);
        }

        .samples-trigger-btn span {
            font-size: 10px;
            margin-top: 4px;
            text-transform: uppercase;
        }

        .inspiration-box {
            background: #1A1A20;
            border: 1px solid #333;
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Groove Extractor Split Layout */
        .groove-split-controls {
            display: flex;
            gap: 10px;
            height: 90px;
            flex-shrink: 0;
            margin-bottom: 20px;
        }

        .groove-drop-mini {
            flex: 1;
            background: rgba(0, 0, 0, 0.2);
            border: 2px dashed #444;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 5px;
            transition: all 0.2s;
            cursor: pointer;
            overflow: hidden;
        }

        .groove-drop-mini:hover {
            border-color: #666;
            background: rgba(255, 255, 255, 0.05);
        }

        .groove-analyze-box {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .groove-analyze-btn-large {
            width: 100%;
            height: 100%;
            background: #252830;
            border: 1px solid #444;
            color: #888;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            cursor: not-allowed;
            text-transform: uppercase;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 10px;
        }

        .groove-analyze-btn-large:hover:not(:disabled) {
            background: #4DB6AC;
            color: #000;
            border-color: #4DB6AC;
        }

        /* Sample Browser Overlay (FL Studio Style) */
        #sample-browser-overlay {
            position: absolute;
            top: 90px;
            /* Below the top header row */
            left: 0;
            width: 100%;
            height: calc(100% - 90px);
            /* Fill remaining height */
            background: #1e1e24;
            border-top: 1px solid #333;
            z-index: 20;
            /* Above Groove Extractor */
            display: none;
            /* Hidden by default */
            flex-direction: column;
            overflow: hidden;
        }

        #sample-browser-overlay.active {
            display: flex;
        }

        .browser-header {
            height: 30px;
            background: #252830;
            border-bottom: 1px solid #333;
            display: flex;
            align-items: center;
            padding: 0 10px;
            font-size: 11px;
            font-weight: 700;
            color: #ccc;
        }

        .browser-tree {
            flex: 1;
            overflow-y: auto;
            padding: 5px 0;
            font-family: 'Consolas', monospace;
            /* Monospace for alignment look */
        }

        .tree-item {
            padding: 4px 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            color: #aaa;
            font-size: 12px;
            user-select: none;
            transition: background 0.1s;
        }

        .tree-item:hover {
            background: #2A2D35;
            color: #fff;
        }

        .tree-item.selected {
            background: #364652;
            /* FL Studioish selection color */
            color: #fff;
        }

        .tree-icon {
            width: 14px;
            height: 14px;
            margin-right: 6px;
            fill: currentColor;
            opacity: 0.7;
        }

        /* Indentation classes */
        .indent-1 {
            padding-left: 20px;
        }

        .indent-2 {
            padding-left: 35px;
        }

        .folder-open .tree-icon {
            opacity: 1;
            color: #E6C543;
        }

        /* Folder color */
        .file-audio .tree-icon {
            color: #4DB6AC;
        }

        /* Audio file color */



        .sound-library-box {
            flex: 0 0 40%;
            /* Top 40% */
        }

        .groove-extractor-box {
            flex: 1;
            /* Bottom 60% (Remaining) */
        }

        /* Box Header & Tabs */
        .box-header {
            height: 36px;
            background: #252830;
            border-bottom: 1px solid #333;
            display: flex;
            align-items: center;
            padding: 0 10px;
        }

        .box-title {
            font-size: 12px;
            font-weight: 700;
            color: #ccc;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Library Tabs */
        .lib-tabs {
            display: flex;
            height: 100%;
            margin-left: -10px;
            /* Align to left edge */
        }

        .lib-tab {
            background: transparent;
            border: none;
            color: #888;
            font-size: 11px;
            font-weight: 600;
            padding: 0 15px;
            height: 100%;
            cursor: pointer;
            border-right: 1px solid #333;
            transition: all 0.2s;
            text-transform: uppercase;
        }

        .lib-tab:hover {
            color: #fff;
            background: rgba(255, 255, 255, 0.05);
        }

        .lib-tab.active {
            color: #4DFFFF;
            /* Neon Cyan */
            background: #1A1A20;
            /* Blend with body */
            border-bottom: 2px solid #4DFFFF;
        }

        /* Content Areas */
        .box-content {
            padding: 15px;
            overflow-y: auto;
            flex: 1;
        }

        /* Sample List Mockup */
        .sample-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sample-item {
            display: flex;
            align-items: center;
            padding: 6px 8px;
            font-size: 12px;
            color: #aaa;
            cursor: pointer;
            border-radius: 4px;
        }

        .sample-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
        }

        .sample-icon {
            margin-right: 8px;
            opacity: 0.7;
        }

        /* Sequencer container styles consolidated at top */


        /* Global Panel Specifics (Right Side) */
        .global-panel {
            border-right: none;
            border-left: 1px solid rgba(77, 255, 255, 0.15);
            background: linear-gradient(180deg, #18191F 0%, #121216 100%);
            overflow: hidden !important;
            /* Force remove scrollbar */
            justify-content: space-evenly;
            /* Distribute vertical space */
            padding-bottom: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .global-panel .panel-title {
            color: #4DFFFF;
            /* Neon Cyan Restore */
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            padding-bottom: 10px;
            margin-bottom: 10px;
            /* 15px -> 10px */
            border-bottom: 1px solid rgba(77, 255, 255, 0.3);
            text-shadow: 0 0 10px rgba(77, 255, 255, 0.4);
            text-align: center;
        }

        /* Fix internal content of global panel */
        .global-panel .kit-selector,
        .global-panel .global-kit-morph,
        .global-panel .global-humanize,
        .global-panel .global-swing {
            width: 100%;
            margin-bottom: 12px;
            /* 20px -> 12px (Compact) */
        }

        /* Restore text colors in global panel */
        .global-panel .humanize-label,
        .global-panel .step-label,
        .global-panel .morph-label {
            color: #ccc;
        }

        .global-panel .humanize-value,
        .global-panel .step-value {
            color: #4DFFFF;
            text-shadow: 0 0 5px rgba(77, 255, 255, 0.5);
        }

        /* Flexible Layout Override */
        /* Flexible Layout Override */
        .app-flex-layout {
            display: flex !important;
            flex-direction: column !important;
            overflow: hidden !important;
        }

        /* Ensure Header doesn't shrink */
        .header {
            flex: none;
            height: 60px;
        }

        /* Layout Body - Row of Panels */
        .layout-body {
            flex: 1;
            display: flex;
            flex-direction: row;
            overflow: hidden;
            height: 100%;
            position: relative;
            /* Context for z-index */
        }

        /* Panels */
        .layout-panel {
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        .left-panel {
            width: 280px;
            min-width: 200px;
            max-width: 400px;
            flex: none !important;
            /* Prevent Flex resizing */
        }

        .center-panel {
            flex: 1;
            /* Takes remaining space */
            min-width: 400px;
            z-index: 10;
        }

        .right-panel {
            width: 340px;
            min-width: 250px;
            max-width: 800px;
            flex: none !important;
            /* Prevent Flex resizing */
            z-index: 10;
        }

        /* Resizers */
        .resizer-v {
            width: 12px;
            /* Wider hit area */
            margin: 0 -5px;
            /* Center perfectly effectively */
            background: transparent;
            cursor: col-resize;
            flex-shrink: 0;
            z-index: 9999 !important;
            /* Always on top */
            position: relative;
        }

        /* Visual Guide line inside the resizer */
        .resizer-v::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 1px;
            background: #2A2D33;
            transform: translateX(-50%);
            transition: background 0.2s;
        }

        .resizer-v:hover::after,
        .resizer-v.resizing::after {
            background: #4DFFFF;
            width: 2px;
            box-shadow: 0 0 10px #4DFFFF;
        }
    </style>
</head>

<body>




    <div class="app-container app-flex-layout" id="appContainer">
        <!-- Header React Root -->
        <div id="header-root" style="height: 100px; flex-shrink: 0; width: 100%;"></div>

        <div class="layout-body" id="layoutBody"
            style="flex: 1; display: flex; flex-direction: row; overflow: hidden; min-height: 0;">
            <div class="layout-panel left-panel" id="leftPanel">
                <aside class="resource-browser">
                    <div class="sidebar-section">
                        <div class="section-title">AI Generate</div>
                        <div class="ai-generate-box">
                            <div class="desc">Describe the music you want to create</div>
                            <textarea class="prompt-input"
                                placeholder="Enter prompt...">Rainy day lo-fi hip-hop</textarea>
                            <button class="generate-btn">Generate</button>
                            <div style="clear: both;"></div>
                        </div>
                    </div>
                    <div class="sidebar-section">
                        <div class="menu-item">Instruments</div>
                        <div class="menu-item">My Samples</div>
                    </div>
                    <!-- Status Bar -->
                    <div class="status-bar">
                        <div class="status-indicator"></div>
                        <span id="status" class="status-text">Ready</span>
                    </div>
                </aside>
            </div>

            <div class="resizer-v" id="resizerLeft"></div>

            <div class="layout-panel center-panel" id="centerPanel"
                style="flex: 1; position: relative; overflow: hidden; display: flex; flex-direction: column;">
                <!-- React Timeline Root -->
                <div id="timeline-root" style="width: 100%; height: 100%; overflow: hidden;"></div>
            </div>

            <div class="resizer-v" id="resizerRight"></div>

            <div class="layout-panel right-panel" id="rightPanel"
                style="width: 340px; min-width: 250px; max-width: 800px; display: flex; flex-direction: column; background: #16161C; border-left: 1px solid #2A2D33; overflow: hidden; flex: none;">
                <div id="copilot-root" style="width: 100%; height: 100%;"></div>
            </div>
        </div>

        <div class="resizer-h" id="resizerBottom"></div>

        <div class="layout-panel bottom-panel" id="bottomPanel">
            <section class="detail-editor">
                <div class="detail-editor-header">
                    <span class="detail-editor-title">Edit Dock</span>
                    <div class="edit-dock-tabs">
                        <button class="edit-dock-tab active">Step Seq</button>
                        <button class="edit-dock-tab">Piano Roll</button>
                        <button class="edit-dock-tab">Mixer</button>
                        <button class="edit-dock-tab">Audio</button>
                        <button class="edit-dock-tab">Sampler</button>
                    </div>
                </div>
                <!-- Tab Panels Container -->
                <div class="edit-dock-panels-container">
                    <!-- Step Seq Panel -->
                    <div class="edit-dock-panel active" data-panel="step-seq">
                        <div class="step-seq-tab-container" style="display: flex; height: 100%; width: 100%;">
                            <!-- Left Wing Panel - Groove Extractor -->
                            <!-- Left Wing Panel - Inspiration Hub -->
                            <!-- Left Wing Panel - Inspiration Hub -->
                            <div class="wing-panel groove-panel">

                                <!-- Top Row: Split Compact Boxes (Fixed Height) -->
                                <div class="inspiration-header-row">

                                    <!-- Left Box: Kit Selector -->
                                    <div class="mini-box kit-select-box">
                                        <div class="mini-box-label">Kit Select</div>
                                        <div class="kit-dropdown-wrapper">
                                            <select id="kit-select" class="kit-select-compact">
                                                <optgroup label="Synth Kits">
                                                    <option value="synth" selected>Synth</option>
                                                </optgroup>
                                                <optgroup label="Sample Kits">
                                                    <option value="tr808">TR-808</option>
                                                    <option value="tr909">TR-909</option>
                                                    <option value="acoustic">Acoustic</option>
                                                    <option value="electronic">Electronic</option>
                                                </optgroup>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- Right Box: Samples (Placeholder) -->
                                    <div class="mini-box samples-box">
                                        <div class="mini-box-label">Samples</div>
                                        <div class="samples-trigger-btn">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                                <line x1="12" y1="8" x2="12" y2="16"></line>
                                                <line x1="8" y1="12" x2="16" y2="12"></line>
                                            </svg>
                                            <span>Browse</span>
                                        </div>
                                    </div>

                                </div>



                                <!-- Sample Browser Overlay -->
                                <div id="sample-browser-overlay">
                                    <div class="browser-header">
                                        <span>BROWSER</span>
                                        <div style="flex:1"></div>
                                        <div class="browser-import-btn" title="Import Folder"
                                            style="cursor:pointer; margin-right:10px; opacity:0.7;">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                                <polyline points="17 8 12 3 7 8"></polyline>
                                                <line x1="12" y1="3" x2="12" y2="15"></line>
                                            </svg>
                                        </div>
                                        <div class="browser-close" style="cursor:pointer;">×</div>
                                    </div>
                                    <div class="browser-tree" id="browser-tree-content">
                                        <!-- Content populated by JS -->
                                        <div class="tree-item folder-item" data-path="packs">
                                            <svg class="tree-icon" viewBox="0 0 24 24">
                                                <path
                                                    d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z" />
                                            </svg>
                                            Packs
                                        </div>
                                    </div>
                                </div>

                                <!-- Bottom Box: Groove Extractor (Flex 1 - Fills remaining space) -->
                                <div class="inspiration-box groove-extractor-box">
                                    <div class="box-header">
                                        <div class="box-title">Groove Extractor</div>
                                    </div>
                                    <div class="box-content"
                                        style="display: flex; flex-direction: column; overflow: hidden; padding: 20px;">

                                        <!-- Split Controls Row -->
                                        <div class="groove-split-controls">
                                            <!-- Left: Drop Zone -->
                                            <div class="groove-drop-mini" id="groove-drop-zone">
                                                <svg class="groove-drop-icon" viewBox="0 0 24 24" fill="none"
                                                    stroke="currentColor" stroke-width="1.5"
                                                    style="width: 24px; height: 24px; margin-bottom: 5px; opacity: 0.7;">
                                                    <path d="M12 15V3m0 0L7 8m5-5l5 5" />
                                                    <path
                                                        d="M2 17l.621 2.485A2 2 0 004.561 21h14.878a2 2 0 001.94-1.515L22 17" />
                                                </svg>
                                                <div class="groove-drop-text"
                                                    style="font-size: 11px; text-align: center; line-height: 1.2;">
                                                    <strong>Drop Audio</strong><br>
                                                    <span style="font-size: 10px; opacity: 0.6;">or Browse</span>
                                                </div>
                                            </div>

                                            <!-- Right: Analyze Button -->
                                            <div class="groove-analyze-box">
                                                <button class="groove-analyze-btn-large" id="groove-analyze-btn"
                                                    disabled>
                                                    Analyze<br>Groove
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Waveform Display (Hidden initially, shown after load) -->
                                        <div class="groove-waveform" style="display: none;">
                                            <canvas id="groove-waveform-canvas"></canvas>
                                            <div class="groove-waveform-placeholder">NO AUDIO LOADED</div>
                                        </div>

                                        <!-- Groove Amount Slider (Originally at bottom) -->
                                        <div class="groove-controls-bottom" style="margin-top: auto;">
                                            <div class="groove-slider-group">
                                                <div class="groove-slider-label">
                                                    <span>Groove Amount</span>
                                                    <span id="groove-amount-value">0%</span>
                                                </div>
                                                <input type="range" class="groove-slider-input"
                                                    id="groove-amount-slider" min="0" max="100" value="0">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Center - Step Sequencer -->
                            <div class="step-seq-container">
                                <!-- Step Count Toggle (Relocated to Container Top) -->

                                <!-- Left - Track Headers Area -->
                                <div class="step-seq-tracks-area">
                                    <!-- Add Track Button (위쪽, 스크롤 밖) -->
                                    <div class="step-seq-add-track" title="Add Track">
                                        <div class="add-track-btn">
                                            <svg class="add-track-icon" viewBox="0 0 24 24"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <line x1="12" y1="5" x2="12" y2="19" stroke-linecap="round" />
                                                <line x1="5" y1="12" x2="19" y2="12" stroke-linecap="round" />
                                            </svg>
                                        </div>
                                    </div>
                                    <!-- Track Headers (스크롤 영역) -->
                                    <div class="step-seq-tracks">
                                        <!-- Kick Track -->
                                        <div class="step-seq-track-header" data-track="kick">
                                            <div class="smart-rand-btn" title="Smart Randomize">
                                                <svg viewBox="0 0 24 24" class="dice-icon">
                                                    <rect x="3" y="3" width="18" height="18" rx="3" fill="none"
                                                        stroke="currentColor" stroke-width="2" />
                                                    <circle cx="8" cy="8" r="1.5" fill="currentColor" />
                                                    <circle cx="12" cy="12" r="1.5" fill="currentColor" />
                                                    <circle cx="16" cy="16" r="1.5" fill="currentColor" />
                                                </svg>
                                                <span class="smart-rand-label">Smart Rand</span>
                                            </div>
                                            <span class="step-seq-track-name drum-pad-trigger" data-drum="kick"
                                                style="color: #FF6B6B; cursor: pointer;"
                                                title="Click to trigger Kick">Kick</span>
                                        </div>
                                        <!-- Snare Track -->
                                        <div class="step-seq-track-header" data-track="snare">
                                            <div class="smart-rand-btn" title="Smart Randomize">
                                                <svg viewBox="0 0 24 24" class="dice-icon">
                                                    <rect x="3" y="3" width="18" height="18" rx="3" fill="none"
                                                        stroke="currentColor" stroke-width="2" />
                                                    <circle cx="8" cy="8" r="1.5" fill="currentColor" />
                                                    <circle cx="12" cy="12" r="1.5" fill="currentColor" />
                                                    <circle cx="16" cy="16" r="1.5" fill="currentColor" />
                                                </svg>
                                                <span class="smart-rand-label">Smart Rand</span>
                                            </div>
                                            <span class="step-seq-track-name" style="color: #4DFFFF;">Snare</span>
                                        </div>
                                        <!-- Hi-Hat Track -->
                                        <div class="step-seq-track-header" data-track="hihat">
                                            <div class="smart-rand-btn" title="Smart Randomize">
                                                <svg viewBox="0 0 24 24" class="dice-icon">
                                                    <rect x="3" y="3" width="18" height="18" rx="3" fill="none"
                                                        stroke="currentColor" stroke-width="2" />
                                                    <circle cx="8" cy="8" r="1.5" fill="currentColor" />
                                                    <circle cx="12" cy="12" r="1.5" fill="currentColor" />
                                                    <circle cx="16" cy="16" r="1.5" fill="currentColor" />
                                                </svg>
                                                <span class="smart-rand-label">Smart Rand</span>
                                            </div>
                                            <span class="step-seq-track-name" style="color: #4FD272;">Hi-Hat
                                                Closed</span>
                                        </div>
                                        <!-- Perc Track -->
                                        <div class="step-seq-track-header" data-track="perc">
                                            <div class="smart-rand-btn" title="Smart Randomize">
                                                <svg viewBox="0 0 24 24" class="dice-icon">
                                                    <rect x="3" y="3" width="18" height="18" rx="3" fill="none"
                                                        stroke="currentColor" stroke-width="2" />
                                                    <circle cx="8" cy="8" r="1.5" fill="currentColor" />
                                                    <circle cx="12" cy="12" r="1.5" fill="currentColor" />
                                                    <circle cx="16" cy="16" r="1.5" fill="currentColor" />
                                                </svg>
                                                <span class="smart-rand-label">Smart Rand</span>
                                            </div>
                                            <span class="step-seq-track-name" style="color: #D45FFF;">Perc</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Center - 16 Step Grid -->
                                <div class="step-seq-grid-area">
                                    <!-- Pattern Drag Handle (Bridge to Timeline) -->
                                    <div class="pattern-drag-handle"
                                        title="Drag to Timeline -> 16 Steps=4Bars region create" draggable="true">
                                        <svg viewBox="0 0 24 24" width="14" height="14" stroke="currentColor"
                                            stroke-width="2" fill="none">
                                            <rect x="3" y="3" width="7" height="7"></rect>
                                            <rect x="14" y="3" width="7" height="7"></rect>
                                            <rect x="14" y="14" width="7" height="7"></rect>
                                            <rect x="3" y="14" width="7" height="7"></rect>
                                        </svg>
                                        <span class="drag-handle-label">DRAG PTN</span>
                                    </div>

                                    <!-- Beat Ruler with tick marks -->
                                    <div class="step-seq-ruler">
                                        <!-- Beat 1 -->
                                        <div class="step-seq-ruler-beat">
                                            <div class="ruler-tick"><span class="beat-label">1</span></div>
                                            <div class="ruler-tick"></div>
                                            <div class="ruler-tick"></div>
                                            <div class="ruler-tick"></div>
                                        </div>
                                        <!-- Beat 2 -->
                                        <div class="step-seq-ruler-beat">
                                            <div class="ruler-tick"><span class="beat-label">2</span></div>
                                            <div class="ruler-tick"></div>
                                            <div class="ruler-tick"></div>
                                            <div class="ruler-tick"></div>
                                        </div>
                                        <!-- Beat 3 -->
                                        <div class="step-seq-ruler-beat">
                                            <div class="ruler-tick"><span class="beat-label">3</span></div>
                                            <div class="ruler-tick"></div>
                                            <div class="ruler-tick"></div>
                                            <div class="ruler-tick"></div>
                                        </div>
                                        <!-- Beat 4 -->
                                        <div class="step-seq-ruler-beat">
                                            <div class="ruler-tick"><span class="beat-label">4</span></div>
                                            <div class="ruler-tick"></div>
                                            <div class="ruler-tick"></div>
                                            <div class="ruler-tick"></div>
                                        </div>

                                        <!-- FX Labels -->
                                        <div class="fx-labels-header">
                                            <div class="fx-label-item">VOL</div>
                                            <div class="fx-label-item">REV</div>
                                            <div class="fx-label-item">DLY</div>
                                            <div class="fx-label-item">CMP</div>
                                        </div>
                                    </div>
                                    <!-- Grid Rows with scroll container -->
                                    <div class="step-seq-grid-scroll">
                                        <!-- Wave Visualizer - SVG Fluid Wave -->
                                        <div class="wave-visualizer" id="waveVisualizer">
                                            <svg id="wave-svg" viewBox="0 0 100 100" preserveAspectRatio="none">
                                                <defs>
                                                    <linearGradient id="wave-neon-gradient" x1="0%" y1="0%" x2="0%"
                                                        y2="100%">
                                                        <stop offset="0%" style="stop-color:#4DFFFF; stop-opacity:0" />
                                                        <stop offset="50%"
                                                            style="stop-color:#4DFFFF; stop-opacity:0.3" />
                                                        <stop offset="100%"
                                                            style="stop-color:#4DFFFF; stop-opacity:0" />
                                                    </linearGradient>
                                                    <filter id="wave-glow">
                                                        <feGaussianBlur stdDeviation="1.5" result="blur" />
                                                        <feComposite in="SourceGraphic" in2="blur" operator="over" />
                                                    </filter>
                                                </defs>
                                                <path id="wave-path" d="M0 50 L100 50" fill="none"
                                                    stroke="url(#wave-neon-gradient)" stroke-width="1.2"
                                                    filter="url(#wave-glow)"
                                                    style="opacity: 0.6; stroke-linecap: round; stroke-linejoin: round;" />
                                            </svg>
                                        </div>
                                        <div class="step-seq-grid">
                                            <!-- Kick Row: 1, 5, 9, 13 (기본 4비트) -->
                                            <div class="step-seq-row" data-track="kick" data-color="#FF6B6B">
                                                <div class="step-beat-group">
                                                    <div class="step-cell active" data-step="0"></div>
                                                    <div class="step-cell" data-step="1"></div>
                                                    <div class="step-cell" data-step="2"></div>
                                                    <div class="step-cell" data-step="3"></div>
                                                </div>
                                                <div class="step-beat-group">
                                                    <div class="step-cell active" data-step="4"></div>
                                                    <div class="step-cell" data-step="5"></div>
                                                    <div class="step-cell" data-step="6"></div>
                                                    <div class="step-cell" data-step="7"></div>
                                                </div>
                                                <div class="step-beat-group">
                                                    <div class="step-cell active" data-step="8"></div>
                                                    <div class="step-cell" data-step="9"></div>
                                                    <div class="step-cell" data-step="10"></div>
                                                    <div class="step-cell" data-step="11"></div>
                                                </div>
                                                <div class="step-beat-group">
                                                    <div class="step-cell active" data-step="12"></div>
                                                    <div class="step-cell" data-step="13"></div>
                                                    <div class="step-cell" data-step="14"></div>
                                                    <div class="step-cell" data-step="15"></div>
                                                </div>
                                                <!-- Integrated FX -->
                                                <div class="row-divider"></div>
                                                <div class="fx-controls-group">
                                                    <div class="fx-knob mini" style="--val:0%" title="Volume"></div>
                                                    <div class="fx-knob mini" style="--val:0%" title="Reverb"></div>
                                                    <div class="fx-knob mini" style="--val:0%" title="Delay"></div>
                                                    <div class="fx-knob mini" style="--val:0%" title="Compressor">
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Snare Row: 5, 13 (2, 4박 백비트) -->
                                            <div class="step-seq-row" data-track="snare" data-color="#4DFFFF">
                                                <div class="step-beat-group">
                                                    <div class="step-cell" data-step="0"></div>
                                                    <div class="step-cell" data-step="1"></div>
                                                    <div class="step-cell" data-step="2"></div>
                                                    <div class="step-cell" data-step="3"></div>
                                                </div>
                                                <div class="step-beat-group">
                                                    <div class="step-cell active" data-step="4"></div>
                                                    <div class="step-cell" data-step="5"></div>
                                                    <div class="step-cell" data-step="6"></div>
                                                    <div class="step-cell" data-step="7"></div>
                                                </div>
                                                <div class="step-beat-group">
                                                    <div class="step-cell" data-step="8"></div>
                                                    <div class="step-cell" data-step="9"></div>
                                                    <div class="step-cell" data-step="10"></div>
                                                    <div class="step-cell" data-step="11"></div>
                                                </div>
                                                <div class="step-beat-group">
                                                    <div class="step-cell active" data-step="12"></div>
                                                    <div class="step-cell" data-step="13"></div>
                                                    <div class="step-cell" data-step="14"></div>
                                                    <div class="step-cell" data-step="15"></div>
                                                </div>
                                                <!-- Integrated FX -->
                                                <div class="row-divider"></div>
                                                <div class="fx-controls-group">
                                                    <div class="fx-knob mini" style="--val:0%" title="Volume"></div>
                                                    <div class="fx-knob mini" style="--val:0%" title="Reverb"></div>
                                                    <div class="fx-knob mini" style="--val:0%" title="Delay"></div>
                                                    <div class="fx-knob mini" style="--val:0%" title="Compressor">
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Hi-Hat Row: 8비트 (짝수 스텝마다) -->
                                            <div class="step-seq-row" data-track="hihat" data-color="#4FD272">
                                                <div class="step-beat-group">
                                                    <div class="step-cell active" data-step="0"></div>
                                                    <div class="step-cell" data-step="1"></div>
                                                    <div class="step-cell active" data-step="2"></div>
                                                    <div class="step-cell" data-step="3"></div>
                                                </div>
                                                <div class="step-beat-group">
                                                    <div class="step-cell active" data-step="4"></div>
                                                    <div class="step-cell" data-step="5"></div>
                                                    <div class="step-cell active" data-step="6"></div>
                                                    <div class="step-cell" data-step="7"></div>
                                                </div>
                                                <div class="step-beat-group">
                                                    <div class="step-cell active" data-step="8"></div>
                                                    <div class="step-cell" data-step="9"></div>
                                                    <div class="step-cell active" data-step="10"></div>
                                                    <div class="step-cell" data-step="11"></div>
                                                </div>
                                                <div class="step-beat-group">
                                                    <div class="step-cell active" data-step="12"></div>
                                                    <div class="step-cell" data-step="13"></div>
                                                    <div class="step-cell active" data-step="14"></div>
                                                    <div class="step-cell" data-step="15"></div>
                                                </div>
                                                <!-- Integrated FX -->
                                                <div class="row-divider"></div>
                                                <div class="fx-controls-group">
                                                    <div class="fx-knob mini" style="--val:0%" title="Volume"></div>
                                                    <div class="fx-knob mini" style="--val:0%" title="Reverb"></div>
                                                    <div class="fx-knob mini" style="--val:0%" title="Delay"></div>
                                                    <div class="fx-knob mini" style="--val:0%" title="Compressor">
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Perc Row: 비어있음 (사용자 추가) -->
                                            <div class="step-seq-row" data-track="perc" data-color="#D45FFF">
                                                <div class="step-beat-group">
                                                    <div class="step-cell" data-step="0"></div>
                                                    <div class="step-cell" data-step="1"></div>
                                                    <div class="step-cell" data-step="2"></div>
                                                    <div class="step-cell" data-step="3"></div>
                                                </div>
                                                <div class="step-beat-group">
                                                    <div class="step-cell" data-step="4"></div>
                                                    <div class="step-cell" data-step="5"></div>
                                                    <div class="step-cell" data-step="6"></div>
                                                    <div class="step-cell" data-step="7"></div>
                                                </div>
                                                <div class="step-beat-group">
                                                    <div class="step-cell" data-step="8"></div>
                                                    <div class="step-cell" data-step="9"></div>
                                                    <div class="step-cell" data-step="10"></div>
                                                    <div class="step-cell" data-step="11"></div>
                                                </div>
                                                <div class="step-beat-group">
                                                    <div class="step-cell" data-step="12"></div>
                                                    <div class="step-cell" data-step="13"></div>
                                                    <div class="step-cell active" data-step="14"></div>
                                                    <div class="step-cell" data-step="15"></div>
                                                </div>
                                                <!-- Integrated FX -->
                                                <div class="row-divider"></div>
                                                <div class="fx-controls-group">
                                                    <div class="fx-knob mini" style="--val:0%" title="Volume"></div>
                                                    <div class="fx-knob mini" style="--val:0%" title="Reverb"></div>
                                                    <div class="fx-knob mini" style="--val:0%" title="Delay"></div>
                                                    <div class="fx-knob mini" style="--val:0%" title="Compressor">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <!-- Step Count Toggle (Moved here for Flexbox Layout) -->
                                <!-- Step Control Stack (High-Fidelity Hardware Replica) -->
                                <div class="step-controls-stack"
                                    style="position: absolute; top: 15px; right: 10px; width: 96px; display: flex; flex-direction: column; gap: 14px; z-index: 100; padding: 10px 0; border-radius: 4px; background: linear-gradient(180deg, #181818 0%, #111 100%); box-shadow: 0 10px 30px rgba(0,0,0,0.9); align-items: center; justify-content: flex-start;">

                                    <!-- 1. DROP BUTTON (Pentagon/Home Plate Shape) -->
                                    <!-- 1. DROP BUTTON (Image Based) -->
                                    <div class="drop-btn-container led-highlight-btn" draggable="true"
                                        title="Drag to Track"
                                        style="width: 86px; cursor: grab; display: flex; align-items: center; justify-content: center; position: relative; border: none !important; outline: none !important; box-shadow: none !important; border-radius: 18px; z-index: 10;">
                                        <img src="assets/images/drop_to_trk.png" class="drop-btn-img"
                                            onmousedown="this.style.transform='scale(0.95)'"
                                            onmouseup="this.style.transform='scale(1)'"
                                            onmouseleave="this.style.transform='scale(1)'"
                                            style="width: 100%; height: auto; object-fit: contain; transition: transform 0.1s; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.5));">
                                    </div>

                                    <!-- Label for Drop Button -->
                                    <div class="drop-label"
                                        style="font-family: 'Segoe UI', sans-serif; font-size: 10px; font-weight: 600; color: #888; margin-top: -8px; margin-bottom: 2px; text-align: center; pointer-events: none; letter-spacing: 0.5px; z-index: 5;">
                                        Drop to Trk
                                    </div>

                                    <div class="oled-display-container led-highlight-purple"
                                        onclick="toggleDropMenu(event)"
                                        onmousedown="this.querySelector('.oled-screen').style.transform='scale(0.95)'"
                                        onmouseup="this.querySelector('.oled-screen').style.transform='scale(1)'"
                                        onmouseleave="this.querySelector('.oled-screen').style.transform='scale(1)'"
                                        style="position: relative; width: 86px; height: 32px; margin-top: -6px; cursor: pointer; z-index: 100;">

                                        <!-- Visual OLED Screen -->
                                        <div class="oled-screen"
                                            style="width: 100%; height: 100%; background: transparent; border-radius: 6px; border: 1px solid rgba(220, 100, 255, 0.5); box-shadow: 0 0 8px rgba(200, 80, 255, 0.3), inset 0 2px 4px rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; overflow: hidden; transition: transform 0.1s ease;">
                                            <div class="oled-text" id="oled-text-display"
                                                style="font-family: 'Segoe UI', 'Malgun Gothic', sans-serif; font-size: 11px; color: #e080ff; font-weight: 400; letter-spacing: 0.5px; text-shadow: 0 0 8px rgba(220, 100, 255, 0.6); white-space: nowrap;">
                                                DROP OPTION</div>
                                        </div>

                                        <!-- Custom Dropdown Menu -->
                                        <div id="custom-drop-menu" class="custom-dropdown-menu">
                                            <div class="custom-dropdown-item"
                                                onclick="selectDropOption(this, 'midi-merged', event)">
                                                <span>MIDI (Merge)</span> <span class="checkmark">✔</span>
                                            </div>
                                            <div class="custom-dropdown-item"
                                                onclick="selectDropOption(this, 'midi-split', event)">
                                                <span>MIDI (Split)</span> <span class="checkmark">✔</span>
                                            </div>
                                            <div class="custom-dropdown-item"
                                                onclick="selectDropOption(this, 'audio-mix', event)">
                                                <span>Audio (Mix)</span> <span class="checkmark">✔</span>
                                            </div>
                                            <div class="custom-dropdown-item"
                                                onclick="selectDropOption(this, 'audio-stems', event)">
                                                <span>Audio (Stem)</span> <span class="checkmark">✔</span>
                                            </div>
                                        </div>

                                        <!-- Styles and Scripts for Dropdown -->
                                        <style>
                                            .custom-dropdown-menu {
                                                display: none;
                                                /* Toggled via JS to 'flex' */
                                                position: absolute;
                                                top: 110%;
                                                left: 50%;
                                                transform: translateX(-50%);
                                                width: 108px;
                                                background: #000;
                                                border: 1px solid rgba(220, 100, 255, 0.5);
                                                border-radius: 12px;
                                                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.9), 0 0 10px rgba(220, 100, 255, 0.2);
                                                z-index: 9999;
                                                flex-direction: column;
                                                overflow: hidden;
                                                padding: 4px;
                                            }

                                            .custom-dropdown-item {
                                                display: flex;
                                                align-items: center;
                                                justify-content: space-between;
                                                padding: 8px 12px;
                                                color: #c080ff;
                                                font-family: 'Segoe UI', sans-serif;
                                                font-size: 11px;
                                                text-align: left;
                                                cursor: pointer;
                                                border-radius: 6px;
                                                transition: all 0.1s ease;
                                            }

                                            .custom-dropdown-item:hover {
                                                background: rgba(220, 100, 255, 0.2);
                                                color: #fff;
                                                text-shadow: 0 0 8px rgba(220, 100, 255, 0.8);
                                            }

                                            .custom-dropdown-item .checkmark {
                                                opacity: 0;
                                                color: #0ff;
                                                /* Cyan checkmark for contrast */
                                                text-shadow: 0 0 5px rgba(0, 255, 255, 0.8);
                                                font-weight: bold;
                                            }

                                            .custom-dropdown-item.selected {
                                                background: rgba(220, 100, 255, 0.1);
                                                color: #fff;
                                            }

                                            .custom-dropdown-item.selected .checkmark {
                                                opacity: 1;
                                            }
                                        </style>

                                        <script>
                                            function toggleDropMenu(e) {
                                                e.stopPropagation();
                                                const menu = document.getElementById('custom-drop-menu');
                                                menu.style.display = (menu.style.display === 'flex') ? 'none' : 'flex';
                                            }

                                            function selectDropOption(element, value, e) {
                                                e.stopPropagation();

                                                // 1. Deselect all
                                                const items = document.querySelectorAll('.custom-dropdown-item');
                                                items.forEach(item => item.classList.remove('selected'));

                                                // 2. Select clicked
                                                element.classList.add('selected');

                                                // 3. Close Menu
                                                document.getElementById('custom-drop-menu').style.display = 'none';

                                                // Note: We DO NOT change the OLED text display as requested.
                                                // It remains "DROP OPTION".
                                                console.log("Selected Drop Option:", value);
                                            }

                                            // Close menu when clicking outside
                                            document.addEventListener('click', function (e) {
                                                const menu = document.getElementById('custom-drop-menu');
                                                if (menu && menu.style.display === 'flex') {
                                                    menu.style.display = 'none';
                                                }
                                            });
                                        </script>
                                    </div>

                                    <!-- 3. 32 STEPS BUTTON (Image Based) -->
                                    <div class="step-toggle-btn step-count-toggle led-highlight-btn"
                                        title="Toggle 16/32 Steps"
                                        style="width: 86px; height: 36px; position: relative; cursor: pointer; transition: transform 0.1s; margin: 4px auto 0 auto; display: flex; align-items: center; justify-content: center; flex-shrink: 0; border: none !important; outline: none !important; box-shadow: none !important; border-radius: 18px; z-index: 10;">

                                        <!-- Image for 16 Steps (Default) -->
                                        <img src="assets/images/btn_16_steps.png" class="step-img-16"
                                            onmousedown="this.style.transform='scale(0.95)'"
                                            onmouseup="this.style.transform='scale(1)'"
                                            onmouseleave="this.style.transform='scale(1)'"
                                            style="width: 100%; height: 100%; object-fit: contain; position: absolute; top: 0; left: 0; opacity: 0; transition: opacity 0.2s, transform 0.1s;">

                                        <!-- Image for 32 Steps (Hidden by default) -->
                                        <img src="assets/images/btn_32_steps.png" class="step-img-32"
                                            onmousedown="this.style.transform='scale(0.95)'"
                                            onmouseup="this.style.transform='scale(1)'"
                                            onmouseleave="this.style.transform='scale(1)'"
                                            style="width: 100%; height: 100%; object-fit: contain; position: absolute; top: 0; left: 0; transition: opacity 0.2s, transform 0.1s;">

                                        <!-- Hidden Text for JS Compatibility (Required for main.ts logic) -->
                                        <span class="step-count-value" style="display: none;">32</span>

                                        <!-- Inline CSS for Toggle Logic -->
                                        <style>
                                            .step-count-toggle.expanded .step-img-16 {
                                                opacity: 1 !important;
                                            }

                                            .step-count-toggle.expanded .step-img-32 {
                                                opacity: 0 !important;
                                            }

                                            /* LED Hover Effect */
                                            .led-highlight-btn {
                                                transition: all 0.2s ease;
                                            }

                                            .led-highlight-btn:hover {
                                                background: rgba(0, 40, 40, 0.6);
                                                box-shadow: 0 0 8px rgba(0, 255, 255, 0.3);
                                                transform: translateY(-2px);
                                            }

                                            .led-highlight-btn::after {
                                                content: '';
                                                position: absolute;
                                                top: 50%;
                                                left: 50%;
                                                transform: translate(-50%, -50%);
                                                width: 0;
                                                height: 0;
                                                background: radial-gradient(circle, rgba(200, 255, 255, 1) 0%, rgba(77, 255, 255, 0) 70%);
                                                border-radius: 50%;
                                                opacity: 0;
                                                transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
                                                pointer-events: none;
                                                z-index: 10;
                                                box-shadow: 0 0 15px 5px rgba(77, 255, 255, 0.8);
                                                mix-blend-mode: screen;
                                            }

                                            .led-highlight-btn:hover::after {
                                                width: 30px;
                                                height: 12px;
                                                opacity: 1;
                                                filter: blur(2px);
                                            }

                                            /* Purple LED Highlight for Drop Option */
                                            .led-highlight-purple {
                                                transition: all 0.2s ease;
                                            }

                                            .led-highlight-purple:hover {
                                                background: rgba(80, 0, 100, 0.4);
                                                box-shadow: 0 0 15px rgba(220, 100, 255, 0.6), inset 0 0 10px rgba(220, 100, 255, 0.2);
                                                transform: translateY(-2px);
                                                border-color: rgba(220, 100, 255, 0.8) !important;
                                            }

                                            .led-highlight-purple:hover .oled-text {
                                                text-shadow: 0 0 10px rgba(220, 100, 255, 1);
                                                color: #fff;
                                            }
                                        </style>
                                    </div>
                                </div>

                                <!-- FX Control Area (Right Side) -->
                                <!-- (FX Area Removed) -->
                                <!-- Right Wing Panel - Global Controls -->
                            </div>
                            <!-- Right Wing Panel - Global Controls (Moved OUTSIDE step-seq-container) -->
                            <div class="wing-panel global-panel">
                                <div class="panel-title">Global</div>

                                <!-- Kit Selector moved to Left Panel -->

                                <!-- Swing Control (New) -->
                                <div class="global-swing" style="width: 100%; margin-bottom: 8px;">
                                    <div class="humanize-header">
                                        <span class="humanize-label">Swing</span>
                                        <span id="swing-value" class="humanize-value">0%</span>
                                    </div>
                                    <input type="range" class="humanize-slider" id="swing-slider" min="0" max="100"
                                        value="0" title="Swing amount">
                                </div>

                                <!-- Humanize Slider -->
                                <div class="global-humanize">
                                    <div class="humanize-header">
                                        <span class="humanize-label">Humanize</span>
                                        <span id="humanize-value" class="humanize-value">0%</span>
                                    </div>
                                    <input type="range" class="humanize-slider" id="humanize-slider" min="0" max="100"
                                        value="0" title="Humanize amount">
                                </div>

                            </div>
                        </div>
                    </div>

                    <!-- Piano Roll Panel -->
                    <div class="edit-dock-panel" data-panel="piano-roll">
                        <div class="editor-content">
                            <!-- AI Modifier Panel -->
                            <div class="ai-modifier">
                                <div class="modifier-title">AI Modifier</div>
                                <div class="slider-group">
                                    <div class="slider-label">Rhythm</div>
                                    <div class="slider-bar">
                                        <div class="slider-fill" style="width: 70%;"></div>
                                    </div>
                                </div>
                                <div class="slider-group">
                                    <div class="slider-label">Velocity</div>
                                    <div class="slider-bar">
                                        <div class="slider-fill" style="width: 50%;"></div>
                                    </div>
                                </div>
                                <div class="slider-group">
                                    <div class="slider-label">Humanize</div>
                                    <div class="slider-bar">
                                        <div class="slider-fill" style="width: 30%;"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Piano Roll -->
                            <div class="piano-roll">
                                <!-- Time Ruler -->
                                <div class="piano-roll-ruler">
                                    <div class="piano-roll-ruler-corner">
                                        <span class="midi-clip-name">MIDI 02</span>
                                    </div>
                                    <div class="piano-roll-ruler-content" id="pianoRollRuler">
                                        <!-- Generated by JS -->
                                    </div>
                                </div>

                                <!-- Piano Roll Body -->
                                <div class="piano-roll-body">
                                    <!-- Piano Keys -->
                                    <div class="piano-keys" id="pianoKeys">
                                        <!-- Generated by JS -->
                                    </div>

                                    <!-- MIDI Grid Container -->
                                    <div class="midi-grid-container">
                                        <div class="midi-grid" id="midiGrid">
                                            <!-- Grid background rows -->
                                            <div class="midi-grid-rows" id="midiGridRows">
                                                <!-- Generated by JS -->
                                            </div>
                                            <!-- Grid lines overlay -->
                                            <div class="midi-grid-lines"></div>
                                            <!-- Playhead -->
                                            <div class="piano-roll-playhead" style="left: 0px;"></div>
                                            <!-- MIDI Notes - positioned by JS -->
                                            <div id="midiNotes">
                                                <!-- Generated by JS -->
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <!-- Velocity Section - Cubase Style (Full Width Below) -->
                                <div class="velocity-section">
                                    <div class="velocity-lane">
                                        <div class="velocity-header">
                                            <div class="velocity-label-area">Velocity</div>
                                        </div>
                                        <div class="velocity-grid" id="velocityGrid">
                                            <!-- Velocity bars generated by JS -->
                                        </div>
                                        <div class="velocity-max-label">127</div>
                                    </div>
                                    <div class="velocity-bottom-bar">
                                        <div class="velocity-controls-left">
                                            <div class="velocity-add-btn">+</div>
                                            <div class="velocity-dropdown-btn">▼</div>
                                        </div>
                                        <div class="piano-roll-scrollbar">
                                            <div class="piano-roll-scroll-track">
                                                <div class="piano-roll-scroll-thumb"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Mixer Panel (FL Studio Style) -->
                    <div class="edit-dock-panel" data-panel="mixer">
                        <div class="mixer-wrapper">
                            <div class="mixer-content">
                                <!-- Kick Channel -->
                                <div class="channel-strip" style="--fader-color: #FF6B6B; --knob-color: #FF6B6B;">
                                    <div class="mixer-track-header">
                                        <div class="mixer-color-bar"
                                            style="background: #FF6B6B; box-shadow: 0 0 8px #FF6B6B;"></div>
                                        <div class="mixer-track-name-vertical">Kick</div>
                                    </div>
                                    <div class="mixer-controls-row">
                                        <button class="btn-mixer-ctrl">M</button>
                                        <button class="btn-mixer-ctrl">S</button>
                                    </div>
                                    <div class="smart-knob-wrapper">
                                        <div class="smart-knob active" style="--knob-rotation: 45deg;">
                                            <div class="smart-knob-indicator"></div>
                                            <div class="smart-knob-value">65%</div>
                                        </div>
                                        <div class="smart-knob-label">Punch</div>
                                    </div>
                                    <div class="mixer-fader-section">
                                        <div class="level-meter">
                                            <div class="level-meter-fill" style="height: 75%;"></div>
                                        </div>
                                        <div class="mixer-fader-track">
                                            <div class="mixer-fader-thumb" style="bottom: 70%;"></div>
                                        </div>
                                        <div class="level-meter">
                                            <div class="level-meter-fill" style="height: 72%;"></div>
                                        </div>
                                    </div>
                                    <div class="mixer-vol-display">-3.2</div>
                                </div>

                                <!-- Snare Channel -->
                                <div class="channel-strip" style="--fader-color: #4DFFFF; --knob-color: #4DFFFF;">
                                    <div class="mixer-track-header">
                                        <div class="mixer-color-bar"
                                            style="background: #4DFFFF; box-shadow: 0 0 8px #4DFFFF;"></div>
                                        <div class="mixer-track-name-vertical">Snare</div>
                                    </div>
                                    <div class="mixer-controls-row">
                                        <button class="btn-mixer-ctrl">M</button>
                                        <button class="btn-mixer-ctrl">S</button>
                                    </div>
                                    <div class="smart-knob-wrapper">
                                        <div class="smart-knob" style="--knob-rotation: 30deg;">
                                            <div class="smart-knob-indicator"></div>
                                            <div class="smart-knob-value">50%</div>
                                        </div>
                                        <div class="smart-knob-label">Crack</div>
                                    </div>
                                    <div class="mixer-fader-section">
                                        <div class="level-meter">
                                            <div class="level-meter-fill" style="height: 55%;"></div>
                                        </div>
                                        <div class="mixer-fader-track">
                                            <div class="mixer-fader-thumb" style="bottom: 60%;"></div>
                                        </div>
                                        <div class="level-meter">
                                            <div class="level-meter-fill" style="height: 52%;"></div>
                                        </div>
                                    </div>
                                    <div class="mixer-vol-display">-6.0</div>
                                </div>

                                <!-- Hi-Hat Channel -->
                                <div class="channel-strip" style="--fader-color: #4FD272; --knob-color: #4FD272;">
                                    <div class="mixer-track-header">
                                        <div class="mixer-color-bar"
                                            style="background: #4FD272; box-shadow: 0 0 8px #4FD272;"></div>
                                        <div class="mixer-track-name-vertical">Hi-Hat</div>
                                    </div>
                                    <div class="mixer-controls-row">
                                        <button class="btn-mixer-ctrl">M</button>
                                        <button class="btn-mixer-ctrl active-solo">S</button>
                                    </div>
                                    <div class="smart-knob-wrapper">
                                        <div class="smart-knob active" style="--knob-rotation: 60deg;">
                                            <div class="smart-knob-indicator"></div>
                                            <div class="smart-knob-value">72%</div>
                                        </div>
                                        <div class="smart-knob-label">Crisp</div>
                                    </div>
                                    <div class="mixer-fader-section">
                                        <div class="level-meter">
                                            <div class="level-meter-fill" style="height: 45%;"></div>
                                        </div>
                                        <div class="mixer-fader-track">
                                            <div class="mixer-fader-thumb" style="bottom: 50%;"></div>
                                        </div>
                                        <div class="level-meter">
                                            <div class="level-meter-fill" style="height: 42%;"></div>
                                        </div>
                                    </div>
                                    <div class="mixer-vol-display">-8.5</div>
                                </div>

                                <!-- Perc Channel -->
                                <div class="channel-strip" style="--fader-color: #D45FFF; --knob-color: #D45FFF;">
                                    <div class="mixer-track-header">
                                        <div class="mixer-color-bar"
                                            style="background: #D45FFF; box-shadow: 0 0 8px #D45FFF;"></div>
                                        <div class="mixer-track-name-vertical">Perc</div>
                                    </div>
                                    <div class="mixer-controls-row">
                                        <button class="btn-mixer-ctrl active-mute">M</button>
                                        <button class="btn-mixer-ctrl">S</button>
                                    </div>
                                    <div class="smart-knob-wrapper">
                                        <div class="smart-knob" style="--knob-rotation: -45deg;">
                                            <div class="smart-knob-indicator"></div>
                                            <div class="smart-knob-value">25%</div>
                                        </div>
                                        <div class="smart-knob-label">Body</div>
                                    </div>
                                    <div class="mixer-fader-section">
                                        <div class="level-meter">
                                            <div class="level-meter-fill" style="height: 0%;"></div>
                                        </div>
                                        <div class="mixer-fader-track">
                                            <div class="mixer-fader-thumb" style="bottom: 5%;"></div>
                                        </div>
                                        <div class="level-meter">
                                            <div class="level-meter-fill" style="height: 0%;"></div>
                                        </div>
                                    </div>
                                    <div class="mixer-vol-display">-??/div>
                                    </div>

                                    <!-- Bass Channel -->
                                    <div class="channel-strip" style="--fader-color: #F39C12; --knob-color: #F39C12;">
                                        <div class="mixer-track-header">
                                            <div class="mixer-color-bar"
                                                style="background: #F39C12; box-shadow: 0 0 8px #F39C12;"></div>
                                            <div class="mixer-track-name-vertical">Bass</div>
                                        </div>
                                        <div class="mixer-controls-row">
                                            <button class="btn-mixer-ctrl">M</button>
                                            <button class="btn-mixer-ctrl">S</button>
                                        </div>
                                        <div class="smart-knob-wrapper">
                                            <div class="smart-knob active" style="--knob-rotation: 75deg;">
                                                <div class="smart-knob-indicator"></div>
                                                <div class="smart-knob-value">80%</div>
                                            </div>
                                            <div class="smart-knob-label">Grit</div>
                                        </div>
                                        <div class="mixer-fader-section">
                                            <div class="level-meter">
                                                <div class="level-meter-fill" style="height: 68%;"></div>
                                            </div>
                                            <div class="mixer-fader-track">
                                                <div class="mixer-fader-thumb" style="bottom: 65%;"></div>
                                            </div>
                                            <div class="level-meter">
                                                <div class="level-meter-fill" style="height: 65%;"></div>
                                            </div>
                                        </div>
                                        <div class="mixer-vol-display">-4.2</div>
                                    </div>

                                    <!-- Piano Channel -->
                                    <div class="channel-strip" style="--fader-color: #5DADE2; --knob-color: #5DADE2;">
                                        <div class="mixer-track-header">
                                            <div class="mixer-color-bar"
                                                style="background: #5DADE2; box-shadow: 0 0 8px #5DADE2;"></div>
                                            <div class="mixer-track-name-vertical">Piano</div>
                                        </div>
                                        <div class="mixer-controls-row">
                                            <button class="btn-mixer-ctrl">M</button>
                                            <button class="btn-mixer-ctrl">S</button>
                                        </div>
                                        <div class="smart-knob-wrapper">
                                            <div class="smart-knob" style="--knob-rotation: 20deg;">
                                                <div class="smart-knob-indicator"></div>
                                                <div class="smart-knob-value">40%</div>
                                            </div>
                                            <div class="smart-knob-label">Space</div>
                                        </div>
                                        <div class="mixer-fader-section">
                                            <div class="level-meter">
                                                <div class="level-meter-fill" style="height: 58%;"></div>
                                            </div>
                                            <div class="mixer-fader-track">
                                                <div class="mixer-fader-thumb" style="bottom: 55%;"></div>
                                            </div>
                                            <div class="level-meter">
                                                <div class="level-meter-fill" style="height: 55%;"></div>
                                            </div>
                                        </div>
                                        <div class="mixer-vol-display">-4.8</div>
                                    </div>

                                    <!-- Vocal Channel -->
                                    <div class="channel-strip" style="--fader-color: #9B59B6; --knob-color: #9B59B6;">
                                        <div class="mixer-track-header">
                                            <div class="mixer-color-bar"
                                                style="background: #9B59B6; box-shadow: 0 0 8px #9B59B6;"></div>
                                            <div class="mixer-track-name-vertical">Vocal</div>
                                        </div>
                                        <div class="mixer-controls-row">
                                            <button class="btn-mixer-ctrl">M</button>
                                            <button class="btn-mixer-ctrl">S</button>
                                        </div>
                                        <div class="smart-knob-wrapper">
                                            <div class="smart-knob active" style="--knob-rotation: 55deg;">
                                                <div class="smart-knob-indicator"></div>
                                                <div class="smart-knob-value">68%</div>
                                            </div>
                                            <div class="smart-knob-label">Air</div>
                                        </div>
                                        <div class="mixer-fader-section">
                                            <div class="level-meter">
                                                <div class="level-meter-fill" style="height: 82%;"></div>
                                            </div>
                                            <div class="mixer-fader-track">
                                                <div class="mixer-fader-thumb" style="bottom: 78%;"></div>
                                            </div>
                                            <div class="level-meter">
                                                <div class="level-meter-fill" style="height: 80%;"></div>
                                            </div>
                                        </div>
                                        <div class="mixer-vol-display">-1.5</div>
                                    </div>

                                    <!-- Separator -->
                                    <div class="mixer-separator"></div>

                                    <!-- FX Channel -->
                                    <div class="channel-strip fx-strip"
                                        style="--fader-color: #FF6B9D; --knob-color: #FF6B9D;">
                                        <div class="mixer-track-header">
                                            <div class="mixer-color-bar"
                                                style="background: #FF6B9D; box-shadow: 0 0 8px #FF6B9D;"></div>
                                            <div class="mixer-track-name-vertical">FX</div>
                                        </div>
                                        <div class="mixer-controls-row">
                                            <button class="btn-mixer-ctrl">M</button>
                                            <button class="btn-mixer-ctrl">S</button>
                                        </div>
                                        <div class="smart-knob-wrapper">
                                            <div class="smart-knob" style="--knob-rotation: 35deg;">
                                                <div class="smart-knob-indicator"></div>
                                                <div class="smart-knob-value">55%</div>
                                            </div>
                                            <div class="smart-knob-label">Send</div>
                                        </div>
                                        <div class="mixer-fader-section">
                                            <div class="level-meter">
                                                <div class="level-meter-fill" style="height: 45%;"></div>
                                            </div>
                                            <div class="mixer-fader-track">
                                                <div class="mixer-fader-thumb" style="bottom: 50%;"></div>
                                            </div>
                                            <div class="level-meter">
                                                <div class="level-meter-fill" style="height: 42%;"></div>
                                            </div>
                                        </div>
                                        <div class="mixer-vol-display">-6.0</div>
                                    </div>

                                    <!-- Group Channel -->
                                    <div class="channel-strip group-strip"
                                        style="--fader-color: #00BFFF; --knob-color: #00BFFF;">
                                        <div class="mixer-track-header">
                                            <div class="mixer-color-bar"
                                                style="background: #00BFFF; box-shadow: 0 0 8px #00BFFF;"></div>
                                            <div class="mixer-track-name-vertical">Group</div>
                                        </div>
                                        <div class="mixer-controls-row">
                                            <button class="btn-mixer-ctrl">M</button>
                                            <button class="btn-mixer-ctrl">S</button>
                                        </div>
                                        <div class="smart-knob-wrapper">
                                            <div class="smart-knob active" style="--knob-rotation: 50deg;">
                                                <div class="smart-knob-indicator"></div>
                                                <div class="smart-knob-value">62%</div>
                                            </div>
                                            <div class="smart-knob-label">Blend</div>
                                        </div>
                                        <div class="mixer-fader-section">
                                            <div class="level-meter">
                                                <div class="level-meter-fill" style="height: 72%;"></div>
                                            </div>
                                            <div class="mixer-fader-track">
                                                <div class="mixer-fader-thumb" style="bottom: 70%;"></div>
                                            </div>
                                            <div class="level-meter">
                                                <div class="level-meter-fill" style="height: 68%;"></div>
                                            </div>
                                        </div>
                                        <div class="mixer-vol-display">-2.5</div>
                                    </div>

                                    <!-- Separator 2 -->
                                    <div class="mixer-separator"></div>

                                    <!-- Master Channel -->
                                    <div class="channel-strip master-strip"
                                        style="--fader-color: #FFD700; --knob-color: #FFD700;">
                                        <div class="mixer-track-header">
                                            <div class="mixer-color-bar"
                                                style="background: #FFD700; box-shadow: 0 0 12px #FFD700;"></div>
                                            <div class="mixer-track-name-vertical">Master</div>
                                        </div>
                                        <div class="mixer-controls-row">
                                            <button class="btn-mixer-ctrl">M</button>
                                            <button class="btn-mixer-ctrl">S</button>
                                        </div>
                                        <div class="smart-knob-wrapper">
                                            <div class="smart-knob active" style="--knob-rotation: 40deg;">
                                                <div class="smart-knob-indicator"></div>
                                                <div class="smart-knob-value">58%</div>
                                            </div>
                                            <div class="smart-knob-label">Loud</div>
                                        </div>
                                        <div class="mixer-fader-section">
                                            <div class="level-meter">
                                                <div class="level-meter-fill" style="height: 88%;"></div>
                                            </div>
                                            <div class="mixer-fader-track">
                                                <div class="mixer-fader-thumb" style="bottom: 85%;"></div>
                                            </div>
                                            <div class="level-meter">
                                                <div class="level-meter-fill" style="height: 86%;"></div>
                                            </div>
                                        </div>
                                        <div class="mixer-vol-display">-0.1</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Audio Panel -->
                        <div class="edit-dock-panel" data-panel="audio">
                            <div class="empty-panel-placeholder">Audio Editor</div>
                        </div>

                        <!-- Sampler Panel -->
                        <div class="edit-dock-panel" data-panel="sampler">
                            <div class="empty-panel-placeholder">Sampler</div>
                        </div>
                    </div><!-- End of edit-dock-panels-container -->
            </section>



        </div>

        <!-- Loading Spinner -->
        <div id="library-loader">
            <div class="spinner"></div>
            <div id="loader-text" style="color: #4FD272; font-size: 14px; font-weight: 500;">Library Parsing...</div>
        </div>

        <script type="module" src="/src/main.ts"></script>

        <!-- Local File Import Input -->
        <input type="file" id="folder-input" webkitdirectory directory multiple style="display:none">
        <style>
            /* AURA Premium Browser UI Refinement */
            #sample-browser-overlay {
                width: 260px !important;
                /* Narrower width */
                max-height: 400px !important;
                top: 85px !important;
                /* Positioned just below Samples box */
                left: 20px !important;
                right: auto !important;
                bottom: auto !important;
                border-radius: 16px !important;
                /* More rounded */
                background: #1A1A20 !important;
                border: 1px solid #353840 !important;
                position: absolute !important;
                box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(77, 255, 255, 0.15) !important;
                display: none;
                /* Hidden by default */
                flex-direction: column;
                overflow: hidden;
                z-index: 10000;
                backdrop-filter: blur(10px);
                animation: popupFadeIn 0.2s cubic-bezier(0.1, 0.9, 0.2, 1);
            }

            @keyframes popupFadeIn {
                from {
                    opacity: 0;
                    transform: translateY(-10px) scale(0.98);
                }

                to {
                    opacity: 1;
                    transform: translateY(0) scale(1);
                }
            }

            .browser-header {
                background: #202228 !important;
                padding: 10px 14px !important;
                border-bottom: 1px solid #2A2D33 !important;
                display: flex;
                align-items: center;
            }

            .browser-header span {
                font-size: 10px;
                font-weight: 800;
                letter-spacing: 1.5px;
                color: #606570;
                text-transform: uppercase;
            }

            .browser-import-btn svg {
                transition: all 0.2s ease;
                stroke: #4FD272;
                width: 14px;
                height: 14px;
            }

            .browser-import-btn:hover svg {
                filter: drop-shadow(0 0 5px rgba(79, 210, 114, 0.6));
                transform: scale(1.1);
            }

            .browser-close {
                width: 24px;
                height: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 6px;
                color: #606570;
                font-size: 18px;
                transition: all 0.2s;
                margin-left: 8px;
                cursor: pointer;
            }

            .browser-close:hover {
                background: rgba(255, 107, 107, 0.1);
                color: #FF6B6B;
            }

            .browser-tree {
                padding: 6px !important;
                background: #121216 !important;
                flex: 1;
                overflow-y: auto;
            }

            /* Ultra-Sleek Scrollbar (Matches Sequencer) */
            .browser-tree::-webkit-scrollbar {
                width: 4px;
                /* Thin */
            }

            .browser-tree::-webkit-scrollbar-track {
                background: transparent;
            }

            .browser-tree::-webkit-scrollbar-thumb {
                background: #353840;
                border-radius: 2px;
            }

            .browser-tree::-webkit-scrollbar-thumb:hover {
                background: #505560;
            }

            /* Tree Item Refinement */
            .browser-tree ul {
                padding-left: 12px !important;
            }

            .browser-tree li {
                border-radius: 4px;
                margin-bottom: 1px;
                transition: background 0.15s;
            }

            .browser-tree li:hover {
                background: rgba(255, 255, 255, 0.03);
            }

            .browser-tree summary {
                padding: 4px 6px;
                border-radius: 4px;
                font-size: 12px !important;
            }

            .browser-tree summary:hover {
                background: rgba(255, 255, 255, 0.05);
            }

            .sample-file-active {
                background: rgba(79, 210, 114, 0.15) !important;
                color: #4FD272 !important;
                border-radius: 4px;
            }

            /* =========================================
           Pro Level Center Panel (Neon Noir)
           ========================================= */

            /* 1. Layout Adjustments */
            .step-seq-container {
                display: flex;
                gap: 0;
                /* Tight layout */
                height: 100%;
                overflow: hidden;
            }

            .step-seq-grid-area {
                flex: 0 0 auto;
                /* Allow shrinking */
                width: fit-content;
                /* Wrap content */
                display: flex;
                flex-direction: column;
                position: relative;
            }

            /* 2. FX Strip Area */
            /* 2. FX Strip Area - INTEGRATED INTO ROWS */

            .fx-area-header {
                height: 20px;
                /* Ruler height counterpart */
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 10px;
                color: #606570;
                font-weight: 700;
                border-bottom: 1px solid #2A2D33;
                margin-top: -30px;
                /* Pull into header area */
                background: #141418;
                letter-spacing: 1px;
            }



            /* 3. Neon Knobs */
            .fx-knob-group {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 2px;
                cursor: pointer;
            }

            .fx-knob {
                width: 24px;
                height: 24px;
                border-radius: 50%;
                border: 2px solid #00FFFF;
                /* Neon Cyan */
                position: relative;
                background: rgba(0, 255, 255, 0.05);
                box-shadow: 0 0 5px rgba(0, 255, 255, 0.2);
                transition: all 0.2s ease;
            }

            .fx-knob::after {
                content: '';
                position: absolute;
                top: 50%;
                left: 50%;
                width: 2px;
                height: 8px;
                background: #00FFFF;
                transform: translate(-50%, -50%) rotate(calc(var(--val) * 3.6deg));
                /* 0-100% -> 0-360deg */
                transform-origin: bottom center;
                /* Pivot from center */
            }

            .fx-knob:hover {
                box-shadow: 0 0 8px rgba(0, 255, 255, 0.5);
                background: rgba(0, 255, 255, 0.1);
            }

            .fx-label {
                font-size: 8px;
                color: #606570;
                font-weight: 600;
                font-family: 'Inter', sans-serif;
                letter-spacing: 0.5px;
            }

            /* 4. Pattern Drag Handle */
            .pattern-drag-handle {
                position: absolute;
                top: -22px;
                /* Above ruler */
                left: 50%;
                transform: translateX(-50%);
                background: #202228;
                color: #808590;
                border: 1px solid #353840;
                border-radius: 4px;
                padding: 2px 8px;
                display: flex;
                align-items: center;
                gap: 6px;
                cursor: grab;
                z-index: 50;
                transition: all 0.2s;
            }

            .pattern-drag-handle:hover {
                background: #2A2D33;
                color: #E0E0E0;
                border-color: #505560;
            }

            .drag-handle-label {
                font-size: 10px;
                font-weight: 700;
            }

            /* MISSING FX STYLES INJECTED */
            .step-seq-row {
                display: flex !important;
                align-items: center !important;
                padding-right: 8px;
                /* Space for FX */
            }

            .fx-controls-group {
                display: flex;
                align-items: center;
                gap: 6px;
                gap: 6px;
                margin-left: 2px;
                /* Drastically reduced spacing */
                /* Push to right */
                padding-left: 0;
                /* Remove extra padding */
                border-left: none;
                /* Removed duplicate divider */
                height: 30px;
                background: transparent !important;
                /* Force transparent */
            }

            .fx-knob.mini {
                width: 24px;
                height: 24px;
                border-radius: 50%;
                /* Default fallback */
                border: 1px solid #444;
                position: relative;
                background: rgba(255, 255, 255, 0.05);
                cursor: pointer;
                transition: all 0.2s;
                --val: 0%;
                /* Default value to prevent glitch */
            }

            .fx-knob.mini::after {
                content: none !important;
                display: none !important;
            }

            /* Specific Color Overrides if var not inherited */
            /* Specific Color Overrides - Cell Style Matching */
            /* Specific Color Overrides - Neon Ring Style (Layered Gradients) */
            .step-seq-row[data-track="kick"] .fx-knob.mini {
                border: 2px solid rgba(255, 107, 107, 0.3);
                background: radial-gradient(closest-side, #16161C 50%, transparent 54%),
                    conic-gradient(from 180deg, #FF6B6B var(--val), rgba(255, 107, 107, 0.1) 0);
                box-shadow: inset 0 0 5px rgba(255, 107, 107, 0.1);
            }

            .step-seq-row[data-track="snare"] .fx-knob.mini {
                border: 2px solid rgba(77, 255, 255, 0.3);
                background: radial-gradient(closest-side, #16161C 50%, transparent 54%),
                    conic-gradient(from 180deg, #4DFFFF var(--val), rgba(77, 255, 255, 0.1) 0);
                box-shadow: inset 0 0 5px rgba(77, 255, 255, 0.1);
            }

            .step-seq-row[data-track="hihat"] .fx-knob.mini {
                border: 2px solid rgba(79, 210, 114, 0.3);
                background: radial-gradient(closest-side, #16161C 50%, transparent 54%),
                    conic-gradient(from 180deg, #4FD272 var(--val), rgba(79, 210, 114, 0.1) 0);
                box-shadow: inset 0 0 5px rgba(79, 210, 114, 0.1);
            }

            .step-seq-row[data-track="perc"] .fx-knob.mini {
                border: 2px solid rgba(212, 95, 255, 0.3);
                background: radial-gradient(closest-side, #16161C 50%, transparent 54%),
                    conic-gradient(from 180deg, #D45FFF var(--val), rgba(212, 95, 255, 0.1) 0);
                box-shadow: inset 0 0 5px rgba(212, 95, 255, 0.1);
            }



            .fx-knob.mini:hover {
                transform: scale(1.1);
                filter: brightness(1.2);
                box-shadow: 0 0 8px var(--track-color, rgba(255, 255, 255, 0.3));
            }

            /* Active Highlight States (Neon Glow Enhancements) */
            /* Active Highlight States */
            .step-seq-row[data-track="kick"] .fx-knob.mini.active {
                border: 2px solid #FF6B6B;
                box-shadow: 0 0 12px #FF6B6B, 0 0 20px rgba(255, 107, 107, 0.4), inset 0 0 0 3px rgba(0, 0, 0, 0.3), inset 0 0 0 4px rgba(255, 107, 107, 0.6);
            }

            .step-seq-row[data-track="snare"] .fx-knob.mini.active {
                border: 2px solid #4DFFFF;
                box-shadow: 0 0 12px #4DFFFF, 0 0 20px rgba(77, 255, 255, 0.4), inset 0 0 0 3px rgba(0, 0, 0, 0.3), inset 0 0 0 4px rgba(77, 255, 255, 0.6);
            }

            .step-seq-row[data-track="hihat"] .fx-knob.mini.active {
                border: 2px solid #4FD272;
                box-shadow: 0 0 12px #4FD272, 0 0 20px rgba(79, 210, 114, 0.4), inset 0 0 0 3px rgba(0, 0, 0, 0.3), inset 0 0 0 4px rgba(79, 210, 114, 0.6);
            }

            .step-seq-row[data-track="perc"] .fx-knob.mini.active {
                border: 2px solid #D45FFF;
                box-shadow: 0 0 12px #D45FFF, 0 0 20px rgba(212, 95, 255, 0.4), inset 0 0 0 3px rgba(0, 0, 0, 0.3), inset 0 0 0 4px rgba(212, 95, 255, 0.6);
            }


            /* CRITICAL LAYOUT FIX FOR FX VISIBILITY */
            .step-beat-group {
                flex: 1 !important;
                width: auto !important;
                min-width: 0 !important;
            }

            /* FX Labels in Header */
            .fx-labels-header {
                display: flex;
                align-items: flex-end;
                gap: 6px;
                /* Match FX group gap */
                margin-left: 1px;
                /* Compensate for ruler's padding-left: 6px vs row's 0px + fx group's 2px margin */
                height: 100%;
                padding-bottom: 4px;
                /* Align text baseline with beat numbers */
                order: 999;
                /* Ensure it stays at the end even if beats are added dynamically */
            }

            .fx-label-item {
                width: 24px;
                /* Match knob width */
                text-align: center;
                font-size: 9px;
                font-weight: 700;
                color: #4DFFFF;
                text-shadow: 0 0 5px rgba(77, 255, 255, 0.5);
                letter-spacing: 0.5px;
                line-height: 1.2;
            }

            .fx-controls-group {
                flex-shrink: 0 !important;
                background: transparent !important;
                z-index: 10 !important;
                margin-left: 2px !important;
                display: flex !important;
            }

            /* --- Step Sequencer Context Menu --- */
            .step-context-menu {
                position: fixed;
                z-index: 10000;
                background: rgba(26, 26, 32, 0.98);
                border: 1px solid #4DFFFF;
                /* Neon Cyan */
                border-radius: 8px;
                padding: 4px;
                min-width: 120px;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.6), 0 0 10px rgba(77, 255, 255, 0.2);
                backdrop-filter: blur(10px);
                display: none;
            }

            .menu-item {
                padding: 8px 12px;
                font-size: 12px;
                color: #ccc;
                cursor: pointer;
                border-radius: 4px;
                transition: all 0.2s;
                display: flex;
                justify-content: space-between;
            }

            .menu-item:hover {
                background: rgba(77, 255, 255, 0.15);
                color: #4DFFFF;
            }

            .menu-divider {
                height: 1px;
                background: #333;
                margin: 4px;
            }

            /* Multiplier Visual Badge on Cell */
            .step-cell {
                position: relative;
            }

            .step-cell[data-multiplier]::after {
                content: 'x' attr(data-multiplier);
                position: absolute;
                top: 50%;
                left: 45%;
                transform: translate(-50%, -50%);
                font-size: 14px;
                font-weight: 900;
                color: #fff;
                opacity: 1;
                text-shadow: 0 0 3px #000, 0 0 5px #000;
                pointer-events: none;
                letter-spacing: -0.5px;
                z-index: 5;
            }

            .step-cell[data-multiplier="1"]::after {
                display: none;
            }

            /* ==================== RESIZABLE 5-PANEL LAYOUT STYLES ==================== */
            html,
            body {
                height: 100%;
                overflow: hidden;
                margin: 0;
                padding: 0;
            }

            .app-flex-layout {
                display: flex !important;
                flex-direction: column !important;
                height: 100vh !important;
                overflow: hidden !important;
                width: 100vw !important;
                grid-template-rows: none !important;
                grid-template-columns: none !important;
            }

            .layout-body {
                flex: 1;
                display: flex;
                flex-direction: row;
                overflow: hidden;
                height: 100%;
                min-height: 0;
            }

            .layout-panel {
                overflow: hidden;
                display: flex;
                flex-direction: column;
                position: relative;
            }

            .layout-panel.left-panel {
                width: 280px;
                flex-shrink: 0;
                border-right: 1px solid rgba(255, 255, 255, 0.1);
            }

            .layout-panel.center-panel {
                flex: 1;
                min-width: 0;
            }

            .layout-panel.right-panel {
                width: 300px;
                flex-shrink: 0;
                border-left: 1px solid rgba(255, 255, 255, 0.1);
            }

            .layout-panel.bottom-panel {
                height: 300px;
                flex-shrink: 0;
                border-top: 1px solid rgba(255, 255, 255, 0.1);
                background: #1A1A20;
                display: flex;
                flex-direction: row;
            }

            /* Resizers */
            .resizer-v {
                width: 5px;
                background: #121212;
                cursor: col-resize;
                flex-shrink: 0;
                z-index: 999;
                transition: background 0.2s;
            }

            .resizer-v:hover,
            .resizer-v.resizing {
                background: #4DFFFF;
                box-shadow: 0 0 10px rgba(77, 255, 255, 0.5);
            }

            .resizer-h {
                height: 5px;
                background: #121212;
                cursor: row-resize;
                flex-shrink: 0;
                z-index: 999;
                transition: background 0.2s;
            }

            .resizer-h:hover,
            .resizer-h.resizing {
                background: #4DFFFF;
                box-shadow: 0 0 10px rgba(77, 255, 255, 0.5);
            }

            /* Overrides to adapt existing components */
            .detail-editor {
                height: 100% !important;
                width: 100% !important;
                border-radius: 0 !important;
                border: none !important;
            }

            .resource-browser {
                width: 100% !important;
                height: 100% !important;
                border-right: none !important;
            }

            .ai-copilot {
                width: 100% !important;
                height: 100% !important;
                border-radius: 0 !important;
            }

            /* Make sure timeline takes full height */
            .timeline {
                flex: 1;
                height: 100%;
                display: flex;
                flex-direction: column;
            }

            .timeline-body {
                flex: 1;
                overflow: hidden;
            }

            /* ==================== EDIT DOCK TABS STYLES ==================== */
            .detail-editor {
                display: flex;
                flex-direction: column;
                background: #141418;
            }

            .detail-editor-header {
                height: 32px;
                background: #202228;
                border-bottom: 1px solid #2A2D33;
                display: flex;
                align-items: center;
                padding: 0 10px;
                flex-shrink: 0;
            }

            .detail-editor-title {
                font-size: 11px;
                font-weight: 700;
                color: #606570;
                text-transform: uppercase;
                margin-right: 20px;
                letter-spacing: 1px;
            }

            .edit-dock-tabs {
                display: flex;
                gap: 2px;
                height: 100%;
            }

            .edit-dock-tab {
                background: transparent;
                border: none;
                color: #888;
                padding: 0 16px;
                height: 100%;
                font-size: 11px;
                font-weight: 600;
                cursor: pointer;
                text-transform: uppercase;
                border-bottom: 2px solid transparent;
                transition: all 0.2s;
                outline: none;
            }

            .edit-dock-tab:hover {
                color: #fff;
                background: rgba(255, 255, 255, 0.05);
            }

            .edit-dock-tab.active {
                color: #4DFFFF;
                /* Neon Cyan */
                border-bottom: 2px solid #4DFFFF;
                background: rgba(77, 255, 255, 0.05);
                text-shadow: 0 0 8px rgba(77, 255, 255, 0.4);
            }

            .edit-dock-panels-container {
                flex: 1;
                overflow: hidden;
                position: relative;
                display: flex;
                flex-direction: column;
            }

            .edit-dock-panel {
                display: none;
                flex: 1;
                width: 100%;
                height: 100%;
                overflow: hidden;
            }

            .edit-dock-panel.active {
                display: flex;
                flex-direction: column;
                animation: fadeIn 0.2s ease-out;
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(5px);
                }

                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            /* Layout fixes for inner panels */
            .step-seq-tab-container {
                flex: 1;
                overflow: hidden;
            }

            .editor-content {
                flex: 1;
                display: flex;
                overflow: hidden;
                height: 100%;
            }

            .piano-roll {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: #141418;
                border-left: 1px solid #2A2D33;
            }

            .mixer-wrapper {
                flex: 1;
                overflow-x: auto;
                overflow-y: hidden;
                background: #141418;
                padding: 20px;
                display: flex;
                align-items: flex-start;
            }

            .mixer-content {
                display: flex;
                gap: 4px;
                height: 100%;
            }
        </style>
    </div>

    <script type="module" src="/main.ts"></script>
</body>

</html>